{"version":3,"sources":["../src/js/app.js"],"names":["app","$","selector","context","document","test","getElementById","slice","querySelector","$all","querySelectorAll","divTodoApp","formAddTodo","formEditTodo","formSearch","searchBar","inputSearch","ulSubtasks","divViews","colorPicker","formNewList","fieldsetFolders","formEditList","inputNewFolder","todoAppContainer","taskDetails","hiddenTaskId","todoLists","localStorage","getItem","initClasses","JSON","parse","arr","map","item","list","List","tasks","task","Task","saveToStorage","setItem","stringify","BACKSPACE_KEY","ENTER_KEY","state","activeList","filteredList","nextOnboardingStep","onboarding","currentStep","statusLog","isCompleted","every","status","nextStep","indexOf","updateStatus","val","clickTouch","now","Date","currentDate","getDate","currentYear","getFullYear","isLeapYear","year","monthsArr","name","daysTotal","abbrev","weekdaysArr","full","short","uniqueID","Math","random","toString","camelCased","text","trim","replace","split","str","i","toLowerCase","charAt","toUpperCase","join","createNode","tagName","attributes","children","node","createElement","Object","keys","forEach","key","classes","x","classList","add","dataProp","dataset","setAttribute","child","appendChild","createTextNode","find","initInbox","push","inbox","id","displayList","addEventListener","toggleDone","updateTaskCount","createList","addTodo","e","preventDefault","target","currentTarget","ulActiveList","value","todo","populateList","reset","offsetTop","window","innerHeight","scrollIntoView","focus","itemsArray","itemsList","innerHTML","done","isPriority","dueDate","isDueToday","isDueTomorrow","dueDateText","itemsCollection","length","todoItem","toggleContent","getListByTaskId","lemon","setPriority","itemTitle","renameTodo","j","taskObj","tags","tagLabels","tagsTooltipBtn","class","type","tooltip","tagSummary","toggle","tag","tagLabel","color","insertBefore","todoId","el","contains","parentNode","listHeight","parseInt","getComputedStyle","height","index","findTaskIndex","currentTask","getTask","indexFirstCompleted","findIndex","splice","style","transform","firstCompletedItem","elem","currentTasksList","activeFilter","completedFilter","filteredArray","callback","reduce","acc","filteredTasks","filter","activeTodos","Array","isArray","completedTodos","action","setTimeout","renderList","toggleComplete","todoIndex","subtaskIndex","subIndex","subtasks","populateSubtasks","clearAll","pop","location","reload","prop","k","subitem","addSubtask","currentList","newSubtask","Subtask","subtask","autoHeightResize","enableAutoHeightResize","addNote","note","scrollHeight","newText","editSubtask","newSubtaskText","getAttribute","dueDateLabel","todoItemTitle","remove","populateTaskDetails","documentElement","clientWidth","blur","deleteTask","listObj","taskId","taskIndex","displayTaskSchedule","filterTag","findExistingTag","undefined","existingTag","removeTag","tagIndex","addTag","tagsContainer","newTagInput","deleteTagBtn","newTagNode","checked","todoItemNote","textContent","folder","feather","updateView","viewBtns","createBreadcrumbs","listElement","folderName","listLink","href","openList","breadcrumbs","badgeDueDate","removeEventListener","enableBulkActions","stickToolbar","filterByDate","firstTask","ulSubList","subListTitle","dueDayNumStr","dueMonthAbbrev","dueYearStr","dueDayOfWeek","liFilteredListItem","filterTasks","query","some","includes","ulFilteredList","taskCount","concat","filterTasksByDueDate","dateObj","valueOf","timeFrame","listElem","today","setHours","getMonth","getDay","currentMonthIndex","nextYear","currentMonth","nextMonthIndex","daysInMonth","currentDay","day","tasksDue","reverseIndex","reverse","lastIndex","indexLastPriority","unshift","activeTask","itemsBetween","toggleMenu","siteWrapper","setTagColor","currentColor","className","list_ul","renderListOption","displayPanel","accordion","accordionItems","getElementsByClassName","selectedPanel","createNavItem","iListIcon","spanListName","spanTaskCount","activeTaskCount","aListLink","liItem","renderNavItems","foldersArr","frag","createDocumentFragment","ulFolderPanel","renderFolderOption","iFolderIcon","iChevronIcon","liFolder","folderItems","miscLists","navLinksAll","link","listId","navLink","taskCountDueToday","folderRadio","folderLabel","for","customFolders","listRadio","listLabel","fieldsetLists","addList","newListName","checkedRadio","newFolder","selectedFolder","newList","folder_li","prepEditListForm","btnUpdateList","updateList","listNavLink","listNavItem","console","log","removeAttribute","deleteList","listIndex","populateCalendarYears","date","yearRadio","yearLabel","updateDateInput","dateComponent","newValues","monthNum","monthIndex","selectMonth","currentDueDate","dueMonthIndex","dueMonth","dueDay","prevSelectedMonth","monthDropdown","btnToggleMonthDropdown","radioId","radio","selectedMonth","populateCalendarDays","selectYear","dueYear","prevSelectedYear","btnToggleYearDropdown","yearDropdown","selectedYear","monthStr","month","monthStartingDate","monthStartingDayNum","prevMonth","nextMonth","btnDay","divDay","selectDay","selectedDay","setDueDate","newDueDate","closeModal","errors","error","form","closeTooltip","hideError","initDpCalendar","currentMonthNum","expandSearchBar","stopPropagation","searchInput","checkedItems","allItems","bulkActions","masterCheckbox","btn","disabled","initBulkEditing","checkbox","highlightSelected","checkboxLabel","transferTasks","newListId","newListObj","deleteSelected","hideComponents","continueTour","modal","noDummyTasks","section","step","onboardingStep","trackTourProgress","tooltipSet","prototype","call","sort","a","b","order","dummyTask","selectStep","toolbar","main","scrollTop","stepper","currentListObj","checkedState","moreActionsWrapper","keyCode","lastTag","lastTagBtn","select","body","newFolderRadio","noFolderRadio","nextElementSibling","selectPrevNext","selectedMonthIndex","prevYear","dateRegex","foo","dateStr","monthText","lastDay","dueDateWrapper","parent","grandparent"],"mappings":"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","file":"app.js","sourcesContent":["import List from './List.js';\nimport Task from './Task.js';\nimport Subtask from './Subtask.js';\n\n(function app() {\n  // for feather icons\n\n  /*\n Helper Functions\n */\n\n  /**\n   * Selects single DOM element by id or class name(s)\n   * @param {string} selector - selector(s) using valid CSS syntax to match against element\n   * @param {Node} [context =document] - optional baseElement, of which the element is a descendant\n   * @param {boolean} [all =false] - false to match single element; true to match all elements\n   * @returns {Node} The first element found that matches the selector(s)\n   */\n  function $(selector, context = document) {\n    // Checks if selector matches single CSS id selector syntax and context is set to document\n    return /^#[\\w-]+$/.test(selector) && context === document\n      ? context.getElementById(selector.slice(1))\n      : context.querySelector(selector);\n  }\n\n  function $all(selector, context = document) {\n    return context.querySelectorAll(selector);\n  }\n\n  // Variables\n  const divTodoApp = $('#todoApp');\n  const formAddTodo = $('#addTodoForm');\n  const formEditTodo = $('#editTodoForm');\n  const formSearch = $('#searchForm');\n  const searchBar = $('#searchBar');\n  const inputSearch = $('#searchInput');\n  const ulSubtasks = $('#subtaskList');\n  const divViews = $('#views');\n  const colorPicker = $('#colorPicker');\n  const formNewList = $('#newListForm');\n  const fieldsetFolders = $('#fieldsetFolders');\n  const formEditList = $('#editListForm');\n  const inputNewFolder = $('#newFolderInput');\n  const todoAppContainer = $('#todoAppContainer');\n  const taskDetails = $('#taskDetails');\n  const hiddenTaskId = $('#taskId');\n  const todoLists = localStorage.getItem('todoLists')\n    ? initClasses(JSON.parse(localStorage.getItem('todoLists')))\n    : [];\n\n  // Converts JSON list and task objects back to instances of original classes\n  function initClasses(arr) {\n    return arr.map((item) => {\n      const list = new List(null, null, item);\n      list.tasks = item.tasks.map((task) => new Task(null, task));\n      return list;\n    });\n  }\n\n  const saveToStorage = () =>\n    localStorage.setItem('todoLists', JSON.stringify(todoLists));\n\n  const BACKSPACE_KEY = 8;\n  const ENTER_KEY = 13;\n  const state = {\n    activeList: null,\n    filteredList: null,\n    nextOnboardingStep: null,\n    onboarding: {\n      currentStep: null,\n      statusLog: [false, false, false],\n      get isCompleted() {\n        return this.statusLog.every((status) => status === true);\n      },\n      get nextStep() {\n        return this.isCompleted\n          ? 4\n          : this.currentStep === 3\n            ? this.statusLog.indexOf(false) + 1\n            : this.statusLog.indexOf(false, this.currentStep) + 1;\n      },\n      set updateStatus(val) {\n        this.statusLog[this.currentStep - 1] = val;\n      }\n    }\n  };\n\n  const clickTouch = () =>\n    'ontouchstart' in document === true ? 'touchstart' : 'click';\n\n  const now = new Date();\n  const currentDate = now.getDate();\n  const currentYear = now.getFullYear();\n\n  const isLeapYear = (year) =>\n    (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n\n  const monthsArr = [\n    {\n      name: 'January',\n      daysTotal: 31,\n      abbrev: 'Jan'\n    },\n    {\n      name: 'February',\n      daysTotal: isLeapYear(currentYear) ? 29 : 28,\n      abbrev: 'Feb'\n    },\n    {\n      name: 'March',\n      daysTotal: 31,\n      abbrev: 'Mar'\n    },\n    {\n      name: 'April',\n      daysTotal: 30,\n      abbrev: 'Apr'\n    },\n    {\n      name: 'May',\n      daysTotal: 31,\n      abbrev: 'May'\n    },\n    {\n      name: 'June',\n      daysTotal: 30,\n      abbrev: 'Jun'\n    },\n    {\n      name: 'July',\n      daysTotal: 31,\n      abbrev: 'Jul'\n    },\n    {\n      name: 'August',\n      daysTotal: 31,\n      abbrev: 'Aug'\n    },\n    {\n      name: 'September',\n      daysTotal: 30,\n      abbrev: 'Sep'\n    },\n    {\n      name: 'October',\n      daysTotal: 31,\n      abbrev: 'Oct'\n    },\n    {\n      name: 'November',\n      daysTotal: 30,\n      abbrev: 'Nov'\n    },\n    {\n      name: 'December',\n      daysTotal: 31,\n      abbrev: 'Dec'\n    }\n  ];\n\n  const weekdaysArr = [\n    { full: 'Sunday', short: 'Sun' },\n    { full: 'Monday', short: 'Mon' },\n    { full: 'Tuesday', short: 'Tue' },\n    { full: 'Wednesday', short: 'Wed' },\n    { full: 'Thursday', short: 'Thu' },\n    { full: 'Friday', short: 'Fri' },\n    { full: 'Saturday', short: 'Sat' }\n  ];\n\n  // Generates unique ID string, used for identifying todo items.\n  const uniqueID = () =>\n    +Date.now() +\n    Math.random()\n      .toString(36)\n      .slice(2);\n\n  const camelCased = (text) =>\n    text\n      .trim()\n      .replace(/[^A-Za-z0-9 ]/g, '')\n      .split(' ')\n      .map(\n        (str, i) =>\n          i === 0\n            ? str.toLowerCase()\n            : str.charAt(0).toUpperCase() + str.slice(1).toLowerCase()\n      )\n      .join('');\n\n  /**\n   * Creates HTML element with specified tagName, attributes and child nodes.\n   * @param {string} tagName - The type of HTML element to create\n   * @param {Object} attributes - HTML attributes, written as key/value pairs, including:\n   *   - CSS classes (separate multiple classes with a single space)\n   *   - data-* attributes (remember to enclose data- attribute name in quotes)\n   * @param {string|Node} ...children - Child nodes to append; a string represents a Text node\n   * @returns {Node} The new HTML element\n   * @example\n   * // `recipe` represents the following:\n   * `<ul class=\"recipe\" id=\"recipe-01\">\n   *    <li class=\"li ingredient\" data-unit=\"tsp\">1 tsp salt</li>\n   * </ul>`\n   * let ingredient = createNode('li', {class: 'li ingredient', 'data-unit': 'tsp'}, '1 tsp salt');\n   * let recipe = createNode('ul', {class: 'recipe', id: 'recipe-01'}, ingredient);\n   */\n  const createNode = (tagName, attributes, ...children) => {\n    const node = document.createElement(tagName);\n\n    if (attributes) {\n      Object.keys(attributes).forEach((key) => {\n        if (key === 'class') {\n          const classes = attributes[key].split(' ');\n          classes.forEach((x) => node.classList.add(x));\n        } else if (/^data-/.test(key)) {\n          const dataProp = key\n            .slice(5) // removes `data-`\n            .split('-')\n            .map(\n              (str, i) =>\n                i === 0\n                  ? str\n                  : str.charAt(0).toUpperCase() + str.slice(1).toLowerCase()\n            )\n            .join('');\n          node.dataset[dataProp] = attributes[key];\n        } else {\n          node.setAttribute(key, attributes[key]);\n        }\n      });\n    }\n\n    children.forEach((child) => {\n      if (typeof child === 'undefined' || child === null) {\n        return;\n      }\n      if (typeof child === 'string') {\n        node.appendChild(document.createTextNode(child));\n      } else {\n        node.appendChild(child);\n      }\n    });\n\n    return node;\n  };\n\n  if (!todoLists.find((list) => list.name === 'Inbox')) {\n    $('#onboarding').classList.add('is-active');\n    const initInbox = new List('Inbox', 'null');\n    todoLists.push(initInbox);\n    saveToStorage();\n  }\n\n  const inbox = todoLists.find((list) => list.name === 'Inbox');\n  inbox.id = 'inbox';\n  // Populates inbox tasks on load\n  displayList(inbox);\n\n  // Add toggleDone functionality to all prebuilt lists\n  $all('.todo-list').forEach((list) => {\n    list.addEventListener('click', toggleDone);\n    updateTaskCount(list.id);\n  });\n\n  // Creates list node for each list object, except for the inbox list\n  todoLists.forEach((list, i) => {\n    if (i !== 0) {\n      createList(list);\n    }\n  });\n\n  // Adds new task object to current list array\n  function addTodo(e) {\n    e.preventDefault();\n    const target = e.currentTarget;\n\n    const ulActiveList = $('.is-active-list');\n\n    const text = $('#todoInput').value;\n    if (text !== '') {\n      const todo = new Task(text);\n      state.activeList.tasks.push(todo); // Add new item to bottom of the list\n      saveToStorage();\n      populateList(state.activeList.tasks, ulActiveList);\n      updateTaskCount(state.activeList.id);\n    }\n    target.reset();\n    if (target.offsetTop >= window.innerHeight) {\n      $('#todoInput').scrollIntoView(true);\n      $('#todoInput').focus();\n    }\n  }\n\n  // Renders todo objects as list items\n  function populateList(itemsArray = [], itemsList) {\n    itemsList.innerHTML = itemsArray\n      .map(\n        (item, i) => `<li class= \"todo-list__item${\n          item.done ? ' is-done' : ''\n        }${item.isPriority ? ' is-priority' : ''}${\n          item.dueDate ||\n          (state.filteredList !== null && $('#searchInput').value === '')\n            ? ' show-info'\n            : ''\n        }\" data-index=\"${i}\" id=\"${item.id}\">\n<input type=\"checkbox\" id=\"item-${i}\" data-index=\"${i}\" value=\"${item.text}\" ${\n          item.done ? 'checked' : ''\n        } />\n<label for =\"item-${i}\" class=\"todo-list__checkbox\"></label>\n<textarea class=\"form__textarea todo-item__title\" data-index=\"${i}\" data-id=\"${\n          item.id\n        }\">${item.text}</textarea>\n<div class=\"todo-item__tag-labels\"></div><span class=\"lemon\" data-id=\"${\n          item.id\n        }\"></span>${\n          item.dueDate !== null\n            ? `<span class=\"badge--due-date${\n                item.isDueToday\n                  ? ' badge--today'\n                  : item.isDueTomorrow\n                    ? ' badge--tomorrow'\n                    : ''\n              }\">${\n                item.isDueToday\n                  ? 'Today'\n                  : item.isDueTomorrow\n                    ? 'Tomorrow'\n                    : item.dueDateText\n              }</span>`\n            : ''\n        }\n</li>`\n      )\n      .join('');\n\n    const itemsCollection = $all('.todo-list__item', itemsList);\n\n    // Adds event listeners to each list item\n    for (let i = 0; i < itemsCollection.length; i++) {\n      let todoItem = itemsCollection[i];\n      todoItem.addEventListener('click', toggleContent, true);\n\n      if (state.filteredList !== null) {\n        todoItem.addEventListener(\n          'click',\n          (e) => {\n            const id = e.currentTarget.id;\n            state.activeList = getListByTaskId(id);\n          },\n          true\n        );\n      }\n\n      const lemon = $('.lemon', todoItem);\n      lemon.addEventListener('click', setPriority);\n      const itemTitle = $('.todo-item__title', todoItem);\n      itemTitle.addEventListener('click', (e) => {\n        const id = e.currentTarget.dataset.id;\n        state.activeList = getListByTaskId(id);\n      });\n      itemTitle.addEventListener('change', renameTodo);\n\n      // Creates tag labels and badges for each todo item, if any\n      const id = todoItem.id;\n\n      for (let j = 0; j < itemsArray.length; j++) {\n        if (itemsArray[j].id === id) {\n          let taskObj = itemsArray[j];\n\n          // Renders tag labels\n          if (taskObj.tags.length > 0) {\n            const tagLabels = $('.todo-item__tag-labels', todoItem);\n            const tagsTooltipBtn = createNode(\n              'button',\n              {\n                class: 'btn btn--tooltip tag-labels__btn--tooltip',\n                'data-tooltip': '',\n                type: 'button'\n              },\n              '...'\n            );\n            tagsTooltipBtn.dataset.tooltip = itemsArray[j].tagSummary;\n            tagsTooltipBtn.addEventListener('click', (e) => {\n              e.currentTarget.classList.toggle('show-tooltip');\n            });\n            tagLabels.appendChild(tagsTooltipBtn);\n\n            // Renders tag labels\n            taskObj.tags.forEach((tag, i) => {\n              const tagLabel = createNode(\n                'span',\n                {\n                  class: `tag tag-label ${tag.color}`\n                },\n                tag.text\n              );\n              tagLabels.insertBefore(tagLabel, tagsTooltipBtn);\n            });\n          }\n        }\n      }\n    }\n  }\n\n  function getListByTaskId(todoId) {\n    return todoLists.find((list) =>\n      list.tasks.find((task) => task.id === todoId)\n    );\n  }\n\n  // Updates todo object's `done` property to reflect current `checked` state\n  function toggleDone(e) {\n    const el = e.target;\n    if (\n      !el.classList.contains('todo-list__checkbox') ||\n      el.classList.contains('bulk-actions__checkbox')\n    )\n      return;\n\n    const id = el.parentNode.id;\n\n    state.activeList = getListByTaskId(id);\n\n    const ulActiveList = $('.is-active-list');\n    const listHeight = parseInt(window.getComputedStyle(ulActiveList).height);\n    const index = state.activeList.findTaskIndex(id);\n    const currentTask = state.activeList.getTask(id);\n    const indexFirstCompleted = state.activeList.tasks.findIndex(\n      (item) => item.done === true\n    ); // Index of most recently completed task\n\n    currentTask.done = !currentTask.done;\n\n    if (currentTask.done && state.activeList.tasks.length !== 1) {\n      // Moves completed task to bottom of todo list\n      state.activeList.tasks.push(state.activeList.tasks.splice(index, 1)[0]);\n\n      $all('.todo-list__item', ulActiveList).forEach((item, i) => {\n        if (i === index) {\n          item.style.transform = `translateY(${listHeight -\n            item.offsetTop -\n            58}px)`;\n        } else if (i > index) {\n          item.style.transform = `translateY(-58px)`;\n        }\n      });\n    }\n    if (!currentTask.done && index > 0 && indexFirstCompleted !== -1) {\n      $all('.todo-list__item', ulActiveList).forEach((item, i) => {\n        if (i === index) {\n          const firstCompletedItem =\n            state.activeList.tasks[indexFirstCompleted].elem;\n          item.style.transform = `translateY(${firstCompletedItem.offsetTop -\n            item.offsetTop}px)`;\n        } else if (\n          i === indexFirstCompleted ||\n          (i < index && i > indexFirstCompleted)\n        ) {\n          item.style.transform = `translateY(58px)`;\n        }\n      });\n      state.activeList.tasks.splice(\n        indexFirstCompleted,\n        0,\n        state.activeList.tasks.splice(index, 1)[0]\n      );\n    }\n\n    saveToStorage();\n\n    // Update active task count in sidebar\n    updateTaskCount(state.activeList.id);\n\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    const activeFilter = (task) => !task.done;\n    const completedFilter = (task) => task.done;\n    const filteredArray = (arr, callback) =>\n      arr.reduce((acc, list) => {\n        const filteredTasks = list.filter(callback);\n        if (filteredTasks.length > 0) {\n          acc.push(filteredTasks);\n        }\n        return acc;\n      }, []);\n\n    const activeTodos = Array.isArray(currentTasksList[0])\n      ? filteredArray(currentTasksList, activeFilter)\n      : currentTasksList.filter((task) => !task.done);\n    const completedTodos = Array.isArray(currentTasksList[0])\n      ? filteredArray(currentTasksList, completedFilter)\n      : currentTasksList.filter((task) => task.done);\n    const action = divViews.querySelector('.is-selected').dataset.action;\n\n    if (action === 'viewActive') {\n      window.setTimeout(() => {\n        renderList(activeTodos, ulActiveList);\n      }, 300);\n    } else if (action === 'viewCompleted') {\n      window.setTimeout(() => {\n        renderList(completedTodos, ulActiveList);\n      }, 300);\n    } else {\n      window.setTimeout(() => {\n        renderList(currentTasksList, ulActiveList);\n      }, 300);\n    }\n  }\n\n  // Updates subtask object's `done` property to reflect current `checked` state\n  function toggleComplete(e) {\n    if (!e.target.classList.contains('subtask-list__checkbox')) return;\n    const id = formEditTodo.dataset.id;\n    const todoIndex = state.activeList.tasks.findIndex(\n      (task) => task.id === id\n    );\n    const currentTask = state.activeList.tasks.find((task) => task.id === id);\n    const subtaskIndex = e.target.dataset.subIndex;\n    currentTask.subtasks[subtaskIndex].done = !currentTask.subtasks[\n      subtaskIndex\n    ].done;\n    saveToStorage();\n    populateSubtasks(state.activeList.tasks, 'subtasks', ulSubtasks, todoIndex);\n  }\n\n  // Empties todos array and removes all rendered todo items\n  function clearAll(e) {\n    while (todoLists.length > 1) {\n      todoLists.pop(); // Remove all lists, except inbox\n    }\n    while (inbox.tasks.length > 0) {\n      inbox.tasks.pop();\n    }\n    saveToStorage();\n    window.location.reload(true);\n  }\n\n  /**\n   * Renders subtask objects as HTML list items\n   * @param {Array} items\n   * @param {Node} itemsList - the HTML <ul> element to contain the list items\n   */\n  function populateSubtasks(itemsArray = [], prop, itemsList, k) {\n    itemsList.innerHTML = itemsArray[k][prop]\n      .map(\n        (subitem, i) => `<li class=\"subtask-list__item\">\n<input type=\"checkbox\" id=\"i${k}--${i}\" name=\"i${k}--${i}\" data-index=\"${k}\" data-sub-index=\"${i}\" class=\"subtask-list__checkbox\" ${\n          subitem.done ? 'checked' : ''\n        } />\n<label for=\"i${k}--${i}\" class=\"subtask-list__checkbox\" data-index=\"${k}\" data-sub-index=\"${i}\"></label>\n<textarea class=\"form__textarea edit-todo-form__textarea--subtask\" data-index=\"${k}\" data-sub-index=${i}>${\n          subitem.text\n        }</textarea>\n</li>`\n      )\n      .join('');\n  }\n\n  /**\n   * Adds subtask\n   */\n  function addSubtask(e) {\n    e.preventDefault();\n\n    if (e.target.dataset.action !== 'addSubtask') return;\n    const id = hiddenTaskId.value;\n\n    const currentTask = state.activeList.getTask(id);\n    const todoIndex = state.activeList.findTaskIndex(id);\n    const currentList = state.activeList;\n\n    const text = $('#newSubtaskInput').value;\n    if (text) {\n      const newSubtask = new Subtask(text);\n      currentTask.subtasks.push(newSubtask);\n      populateSubtasks(currentList.tasks, 'subtasks', ulSubtasks, todoIndex);\n      $all('.edit-todo-form__textarea--subtask', ulSubtasks).forEach(\n        (subtask) => autoHeightResize(subtask)\n      );\n      saveToStorage();\n      $('#newSubtaskInput').value = '';\n    }\n  }\n\n  function enableAutoHeightResize(e) {\n    autoHeightResize(e.currentTarget);\n  }\n\n  /**\n   * Adds note\n   */\n  function addNote(e) {\n    if (!e.target.classList.contains('todo-item__note')) return;\n    const id = formEditTodo.dataset.id;\n    const currentTask = state.activeList.getTask(id);\n    const todoIndex = state.activeList.findTaskIndex(id); // index of todo object with matching ID in TODOS array\n    const text = e.target.value;\n    if (!/^\\s+$/.test(text)) {\n      currentTask.note = text;\n      saveToStorage();\n    }\n  }\n\n  // Resizes text inputs and textareas to show all content within\n  function autoHeightResize(elem) {\n    elem.style.height = '0px';\n    elem.style.height = `${elem.scrollHeight}px`;\n  }\n\n  function renameTodo(e) {\n    if (!e.target.classList.contains('todo-item__title')) return;\n    const id = e.target.dataset.id;\n    const newText = e.target.value.trim();\n    const currentTask = state.activeList.getTask(id);\n    const todoItem = $(`#${id}`);\n    if (newText !== '') {\n      currentTask.text = newText;\n      saveToStorage();\n\n      if (e.currentTarget === $('#taskName')) {\n        $('.todo-item__title', todoItem).value = newText;\n      } else {\n        if (todoAppContainer.classList.contains('show-task-details')) {\n          $('#taskName').value = newText;\n        }\n      }\n    }\n  }\n\n  function editSubtask(e) {\n    if (!e.target.classList.contains('edit-todo-form__textarea--subtask'))\n      return;\n    const id = e.currentTarget.dataset.id;\n    const currentTask = state.activeList.getTask(id);\n    const newSubtaskText = e.target.value;\n    const subtaskIndex = e.target.dataset.subIndex;\n    currentTask.subtasks[subtaskIndex].text = newSubtaskText.trim();\n    saveToStorage();\n  }\n\n  function toggleContent(e) {\n    if (\n      e.target.classList.contains('lemon') ||\n      e.target.classList.contains('todo-list__checkbox') ||\n      e.target.getAttribute('type') === 'checkbox' ||\n      e.currentTarget.contains(\n        $('.bulk-actions__checkbox-label', e.currentTarget)\n      ) ||\n      e.target.classList.contains('tag-labels__btn--tooltip')\n    )\n      return;\n    let todoItem = e.currentTarget;\n    const id = todoItem.id;\n    const dueDateLabel = $('.badge--due-date', todoItem);\n    const todoItemTitle = $('.todo-item__title', todoItem);\n    const ulActiveList = $('.is-active-list');\n\n    if (e.currentTarget.id === 'btnCloseTaskDetails') {\n      todoItem = $(`#${hiddenTaskId.value}`);\n    }\n\n    if (todoAppContainer.classList.contains('show-task-details')) {\n      todoItem.classList.remove('is-selected');\n      todoAppContainer.classList.remove('show-task-details');\n      // Reset task details pane\n      const tags = $all('#tagsContainer .tag', taskDetails);\n      tags.forEach((x) => x.remove());\n      $('#dueDateWrapper').classList.remove('has-due-date');\n      $('#dueDateWrapper').classList.remove('show-input');\n      $('#dueDateWrapper').parentNode.classList.remove('is-focused');\n      $('#dpCalendar').classList.remove('is-active');\n      $all('.todo-list__item', ulActiveList).forEach((item) =>\n        item.classList.remove('is-selected')\n      );\n    }\n\n    if (\n      !todoAppContainer.classList.contains('show-task-details') &&\n      e.currentTarget.id !== 'btnCloseTaskDetails'\n    ) {\n      hiddenTaskId.value = id;\n      populateTaskDetails(id);\n      $all('.todo-list__item', ulActiveList).forEach((item) => {\n        if (item === todoItem) {\n          item.classList.add('is-selected');\n        } else {\n          item.classList.remove('is-selected');\n        }\n      });\n      if (document.documentElement.clientWidth < 768) {\n        $('.todo-item__title', todoItem).blur();\n      }\n      todoAppContainer.classList.add('show-task-details');\n    }\n  }\n\n  function deleteTask(listObj, taskId) {\n    const currentTask = listObj.getTask(taskId);\n    const todoItem = currentTask.elem;\n    const taskIndex = listObj.findTaskIndex(taskId);\n    const ulActiveList = $('.is-active-list');\n    listObj.tasks.splice(taskIndex, 1);\n    saveToStorage();\n\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    if (todoAppContainer.classList.contains('show-task-details')) {\n      todoAppContainer.classList.remove('show-task-details');\n    }\n    if (!todoItem.classList.contains('bulk-editing-list__item')) {\n      switch (ulActiveList.id) {\n        case 'upcoming':\n          displayTaskSchedule('upcoming', $('#upcoming'));\n          break;\n        case 'today':\n          displayTaskSchedule('today', $('#today'));\n          break;\n        default:\n          renderList(currentTasksList, ulActiveList);\n          break;\n      }\n    }\n    updateTaskCount(listObj.id);\n    if (currentTask.isDueToday) {\n      updateTaskCount('today');\n    }\n    $('#alertWarningDeleteTask').classList.remove('is-active');\n  }\n\n  function filterTag(tag) {\n    return tag\n      .trim()\n      .replace(/  +/g, ' ')\n      .replace(/[^\\w -]/g, '');\n  }\n\n  /**\n   * Returns first existing tag that matches string and undefined if it doesn't exist\n   * @param {num} [todoIndex =0] - limits the search of an existing tag to the todo object at the index provided\n   */\n  function findExistingTag(text, todoIndex = undefined) {\n    let existingTag;\n    const ulActiveList = $('.is-active-list');\n    const currentList = state.activeList;\n    if (todoIndex !== undefined) {\n      existingTag = currentList.tasks[todoIndex].tags.find(\n        (tag) => tag.text === text\n      );\n    } else {\n      for (let i = 0; i < todoLists.length; i++) {\n        for (let j = 0; j < todoLists[i].tasks.length; j++) {\n          existingTag = todoLists[i].tasks[j].tags.find(\n            (tag) => tag.text === text\n          );\n          if (existingTag !== undefined) {\n            break;\n          }\n        }\n        if (existingTag !== undefined) {\n          break;\n        }\n      }\n    }\n    return existingTag;\n  }\n\n  function removeTag(todoIndex, tagIndex) {\n    const currentTask = state.activeList.tasks[todoIndex];\n    const id = currentTask.id;\n    const todoItem = $(`#${id}`);\n    $all('#tagsContainer .tag', formEditTodo)[tagIndex].remove();\n    $all('.todo-item__tag-labels .tag-label', todoItem)[tagIndex].remove();\n    currentTask.tags.splice(tagIndex, 1);\n    saveToStorage();\n    const tagsTooltipBtn = $('.tag-labels__btn--tooltip', todoItem);\n    if (currentTask.tags.length > 0) {\n      // Update tags tooltip\n      tagsTooltipBtn.dataset.tooltip = currentTask.tagSummary;\n    } else {\n      tagsTooltipBtn.remove();\n    }\n  }\n\n  function addTag(e) {\n    if (e.target.dataset.action !== 'addTag' && $('#newTagInput').value === '')\n      return;\n    e.preventDefault();\n    const tagsContainer = $('#tagsContainer');\n    const newTagInput = $('#newTagInput');\n    const id = formEditTodo.dataset.id;\n    const todoIndex = state.activeList.findTaskIndex(id);\n    const currentTask = state.activeList.getTask(id);\n    const todoItem = $(`#${id}`);\n    const tagLabels = $('.todo-item__tag-labels', todoItem);\n    const tagsTooltipBtn =\n      tagLabels.querySelector('.btn--tooltip') ||\n      createNode(\n        'button',\n        {\n          class: 'btn btn--tooltip tag-labels__btn--tooltip',\n          'data-tooltip': '',\n          type: 'button'\n        },\n        '...'\n      );\n    if (!tagLabels.contains(tagsTooltipBtn)) {\n      tagLabels.appendChild(tagsTooltipBtn);\n    }\n    if (newTagInput.value !== '') {\n      const text = filterTag(newTagInput.value);\n\n      // Prevents duplicating existing tags for a todo item\n      if (findExistingTag(text, todoIndex)) return;\n\n      if (text.length > 0) {\n        const existingTag = findExistingTag(text);\n        const tag = {\n          text,\n          // Assigns color of previously created tag that matches text, if exists\n          color: existingTag !== undefined ? existingTag.color : 'bg--default'\n        };\n        state.activeList.tasks[todoIndex].tags.push(tag);\n        saveToStorage();\n        const deleteTagBtn = createNode('button', {\n          class: 'close-icon',\n          type: 'button',\n          value: 'false'\n        });\n        deleteTagBtn.addEventListener(\n          'click',\n          (e) => {\n            removeTag(\n              todoIndex,\n              state.activeList.tasks[todoIndex].tags.indexOf(tag)\n            );\n          },\n          false\n        );\n        const newTagNode = createNode(\n          'span',\n          {\n            class: `tag ${tag.color}`,\n            'data-tag-index': state.activeList.tasks[todoIndex].tags.indexOf(\n              tag\n            )\n          },\n          tag.text,\n          deleteTagBtn\n        );\n        tagsContainer.insertBefore(newTagNode, newTagInput);\n        const tagLabel = createNode(\n          'span',\n          {\n            class: `tag tag-label ${tag.color}`\n          },\n          tag.text\n        );\n\n        // Updates tooltip data\n        tagsTooltipBtn.dataset.tooltip = currentTask.tagSummary;\n        tagLabels.insertBefore(tagLabel, tagsTooltipBtn);\n        newTagInput.value = '';\n\n        // Appends color picker to tag node if there are no existing tags that matches text\n        if (existingTag === undefined) {\n          newTagNode.appendChild(colorPicker);\n          $('#colorDefault', colorPicker).checked = true;\n          colorPicker.classList.add('is-visible');\n        }\n      }\n    }\n  }\n\n  function populateTaskDetails(id) {\n    const todoItem = $(`#${id}`);\n    // Change state to current list object\n    state.activeList = getListByTaskId(id);\n    const ulActiveList = $('.is-active-list');\n    const currentTask = state.activeList.getTask(id);\n    const todoIndex = state.activeList.findTaskIndex(id);\n    const todoItemTitle = $('#taskName');\n    const todoItemNote = $('.todo-item__note', formEditTodo);\n    const newTagInput = $('#newTagInput');\n    const lemon = $('.task-details__lemon', taskDetails);\n    todoItemTitle.value = currentTask.text;\n    todoItemTitle.dataset.id = id;\n    todoItemTitle.dataset.index = todoIndex;\n    todoItemNote.value = currentTask.note;\n    lemon.dataset.id = id;\n\n    if (currentTask.isPriority) {\n      taskDetails.classList.add('is-priority');\n    } else {\n      taskDetails.classList.remove('is-priority');\n    }\n\n    $('#btnCloseTaskDetails .list-name').textContent =\n      ulActiveList.dataset.name;\n    $('#taskDetailsBreadcrumbs .list-name').textContent = state.activeList.name;\n    $('#taskDetailsBreadcrumbs .breadcrumbs__link').setAttribute(\n      'href',\n      `#${state.activeList.id}`\n    );\n\n    if (state.activeList.folder !== 'null') {\n      $('#taskDetailsBreadcrumbs .folder-name').textContent =\n        state.activeList.folder;\n      $('#taskDetailsBreadcrumbs').classList.add('show-folder');\n    } else {\n      $('#taskDetailsBreadcrumbs').classList.remove('show-folder');\n    }\n\n    if (state.activeList.id === 'inbox') {\n      $('#taskDetailsBreadcrumbs .feather-list').classList.add('is-hidden');\n      $('#taskDetailsBreadcrumbs .feather-inbox').classList.remove('is-hidden');\n    } else {\n      $('#taskDetailsBreadcrumbs .feather-inbox').classList.add('is-hidden');\n      $('#taskDetailsBreadcrumbs .feather-list').classList.remove('is-hidden');\n    }\n\n    if (currentTask.dueDate !== null) {\n      $('#dueDateWrapper').classList.add('has-due-date');\n      $('#dueDateWrapper .due-date-text').textContent = currentTask.dueDateText;\n    } else {\n      $('#dueDateWrapper').classList.remove('has-due-date');\n      $('#dueDateWrapper .due-date-text').textContent = 'Set due date';\n    }\n\n    populateSubtasks(state.activeList.tasks, 'subtasks', ulSubtasks, todoIndex);\n    const subtasks = $all('.edit-todo-form__textarea--subtask', ulSubtasks);\n    formEditTodo.dataset.index = todoIndex;\n    formEditTodo.dataset.id = id;\n    colorPicker.dataset.index = todoIndex;\n    colorPicker.dataset.id = id;\n\n    // Readjust height of textareas to display all content within\n    setTimeout(() => {\n      autoHeightResize(todoItemTitle);\n      if (!todoItemNote.value) {\n        todoItemNote.style.height = '0px';\n      } else {\n        autoHeightResize(todoItemNote);\n      }\n      if (currentTask.subtasks.length > 0) {\n        subtasks.forEach((subtask) => autoHeightResize(subtask));\n      }\n    }, 0);\n\n    const tagsContainer = $('#tagsContainer');\n\n    if (currentTask.tags.length > 0) {\n      currentTask.tags.forEach((tag, i) => {\n        const deleteTagBtn = createNode('button', {\n          class: 'close-icon',\n          type: 'button',\n          value: 'false'\n        });\n        deleteTagBtn.addEventListener('click', (e) => {\n          removeTag(todoIndex, i);\n        });\n        const newTagNode = createNode(\n          'span',\n          {\n            class: 'tag',\n            'data-tag-index': i\n          },\n          tag.text,\n          deleteTagBtn\n        );\n        newTagNode.classList.add(tag.color);\n        tagsContainer.insertBefore(newTagNode, newTagInput);\n      });\n    }\n    feather.replace();\n  }\n\n  function updateView(e) {\n    const ulActiveList = $('.is-active-list');\n    const currentTasksList =\n      state.filteredList !== null ? state.filteredList : state.activeList.tasks;\n\n    const activeFilter = (task) => !task.done;\n    const completedFilter = (task) => task.done;\n    const filteredArray = (arr, callback) =>\n      arr.reduce((acc, list) => {\n        const filteredTasks = list.filter(callback);\n        if (filteredTasks.length > 0) {\n          acc.push(filteredTasks);\n        }\n        return acc;\n      }, []);\n    const activeTodos = Array.isArray(currentTasksList[0])\n      ? filteredArray(currentTasksList, activeFilter)\n      : currentTasksList.filter((task) => !task.done);\n    const completedTodos = Array.isArray(currentTasksList[0])\n      ? filteredArray(currentTasksList, completedFilter)\n      : currentTasksList.filter((task) => task.done);\n    const action = e.target.dataset.action;\n    switch (action) {\n      case 'viewAll':\n        renderList(currentTasksList, ulActiveList);\n        break;\n      case 'viewActive':\n        renderList(activeTodos, ulActiveList);\n        break;\n      case 'viewCompleted':\n        renderList(completedTodos, ulActiveList);\n        break;\n    }\n    const viewBtns = divViews.querySelectorAll('.views__btn');\n    // Mark current view displayed by adding '.is-selected' class to corresponding button\n    for (let i = 0; i < viewBtns.length; i++) {\n      if (e.target !== viewBtns[i]) {\n        viewBtns[i].classList.remove('is-selected');\n      } else {\n        viewBtns[i].classList.add('is-selected');\n      }\n    }\n  }\n\n  function createBreadcrumbs(listElement) {\n    $all('.todo-list__item', listElement).forEach((item) => {\n      const list = getListByTaskId(item.id);\n      const folderName =\n        list.folder !== 'null'\n          ? createNode(\n              'span',\n              { class: 'breadcrumbs__folder' },\n              list.folder,\n              createNode('i', { 'data-feather': 'chevron-right' })\n            )\n          : '';\n      const listLink = createNode(\n        'a',\n        { class: 'breadcrumbs__link', href: `#${list.id}` },\n        list.name\n      );\n      listLink.addEventListener('click', openList);\n      const breadcrumbs = createNode(\n        'div',\n        { class: 'breadcrumbs' },\n        folderName,\n        listLink\n      );\n      item.appendChild(breadcrumbs);\n      const badgeDueDate = $('.badge--due-date', item);\n      if (badgeDueDate) {\n        badgeDueDate.classList.add('is-hidden');\n      }\n    });\n    feather.replace();\n  }\n\n  function renderList(itemsArray, itemsList) {\n    const ulActiveList = $('.is-active-list');\n    if (itemsList === $('#filteredList')) {\n      $('#main').classList.add('show-search-results');\n    } else {\n      $('#main').classList.remove('show-search-results');\n    }\n\n    if ($('#bulkActionsToolbar').classList.contains('is-active')) {\n      $('#bulkActionsToolbar').classList.remove('is-active');\n      ulActiveList.removeEventListener('click', enableBulkActions);\n      $('#main').removeEventListener('scroll', stickToolbar);\n      ulActiveList.classList.remove('bulk-editing-list');\n      $('#addTodoForm').classList.remove('is-hidden');\n    }\n\n    if (Array.isArray(itemsArray[0])) {\n      $all('.todo-list').forEach((list) => (list.innerHTML = ''));\n\n      const filterByDate = itemsList === $('#upcoming');\n      itemsArray.forEach((list) => {\n        const taskId = list[0].id;\n        const listObj = getListByTaskId(taskId);\n        const firstTask = listObj.getTask(taskId);\n\n        const folderName =\n          listObj.folder !== 'null'\n            ? createNode(\n                'span',\n                { class: 'filtered-list__folder-name' },\n                listObj.folder,\n                createNode('i', { 'data-feather': 'chevron-right' })\n              )\n            : '';\n        // Create sub-list\n        const ulSubList = createNode('ul', {\n          class: 'filtered-list__sub-list'\n        });\n        // Create list link\n        const subListTitle = filterByDate\n          ? createNode(\n              'h2',\n              { class: 'filtered-list__date filtered-list__sub-list-name' },\n              createNode(\n                'span',\n                { class: 'filtered-list__day-num' },\n                firstTask.dueDayNumStr\n              ),\n              createNode(\n                'span',\n                { class: 'filtered-list__date-group' },\n                createNode(\n                  'span',\n                  { class: 'filtered-list__month' },\n                  firstTask.dueMonthAbbrev\n                ),\n                createNode(\n                  'span',\n                  { class: 'filtered-list__year' },\n                  firstTask.dueYearStr\n                )\n              ),\n              createNode(\n                'span',\n                { class: 'filtered-list__weekday' },\n                firstTask.dueDayOfWeek\n              )\n            )\n          : createNode(\n              'a',\n              {\n                class: 'filtered-list__link filtered-list__sub-list-name',\n                href: `#${listObj.id}`\n              },\n              listObj.name\n            );\n\n        if (filterByDate && firstTask.isDueToday) {\n          subListTitle.classList.add('filtered-list__date--today');\n        } else if (filterByDate && firstTask.isDueTomorrow) {\n          subListTitle.classList.add('filtered-list__date--tomorrow');\n        }\n\n        // Create filtered list item\n        const liFilteredListItem = createNode(\n          'li',\n          { class: 'filtered-list__item' },\n          filterByDate ? '' : folderName,\n          subListTitle,\n          ulSubList\n        );\n        // Populate tasks for each sub-list\n        populateList(list, ulSubList);\n        if (!filterByDate) {\n          subListTitle.addEventListener('click', openList);\n        } else {\n          createBreadcrumbs(ulSubList);\n        }\n        itemsList.appendChild(liFilteredListItem);\n        feather.replace();\n      });\n    } else {\n      populateList(itemsArray, itemsList);\n      if (itemsList === $('#today')) {\n        createBreadcrumbs(itemsList);\n      }\n    }\n  }\n\n  function filterTasks(e) {\n    e.preventDefault();\n    const query = inputSearch.value.toLowerCase();\n    if (query !== '') {\n      const filteredArray = todoLists.reduce((acc, list) => {\n        const filteredTasks = list.tasks.filter((todo) =>\n          Object.keys(todo).some((key) => {\n            if (typeof todo[key] === 'string') {\n              return todo[key].toLowerCase().includes(query);\n            }\n            if (Array.isArray(todo[key])) {\n              return todo[key].some((item) =>\n                item.text.toLowerCase().includes(query)\n              );\n            }\n          })\n        );\n        if (filteredTasks.length > 0) {\n          acc.push(filteredTasks);\n        }\n        return acc;\n      }, []);\n\n      const ulFilteredList = $('#filteredList');\n      state.activeList = null;\n      state.filteredList = filteredArray;\n      renderList(filteredArray, ulFilteredList);\n\n      const taskCount = filteredArray.reduce(\n        (acc, list) => acc.concat(list),\n        []\n      ).length;\n      $('.is-active-list').classList.remove('is-active-list');\n      ulFilteredList.classList.add('is-active-list');\n      $(\n        '#activeListTitle'\n      ).innerHTML = `${taskCount} search result(s) for <strong>${\n        inputSearch.value\n      }</strong>`;\n      formAddTodo.classList.add('is-hidden');\n      inputSearch.blur();\n    }\n  }\n\n  function filterTasksByDueDate(dateObj) {\n    return todoLists.reduce(\n      (acc, list) =>\n        acc.concat(\n          list.tasks.filter(\n            (task) => new Date(task.dueDate).valueOf() === dateObj.valueOf()\n          )\n        ),\n      []\n    );\n  }\n\n  function displayTaskSchedule(timeFrame, listElem) {\n    let filteredArray = [];\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    if (timeFrame === 'today') {\n      filteredArray = filterTasksByDueDate(today);\n      $(\n        '#activeListTitle'\n      ).innerHTML = `<span class=\"filtered-list__weekday--lg\">Today,</span><span class=\"filtered-list__day-num\">${today.getDate()}</span><span class=\"filtered-list__date-group\"><span class=\"filtered-list__month\">${\n        monthsArr[today.getMonth()].abbrev\n      }</span><span class=\"filtered-list__year\">${today.getFullYear()}</span></span><span class=\"filtered-list__weekday\">${\n        weekdaysArr[today.getDay()].full\n      }</span>`;\n    } else if (timeFrame === 'upcoming') {\n      const currentMonthIndex = today.getMonth();\n      const currentYear = today.getFullYear();\n      const nextYear = currentYear + 1;\n      const currentMonth = monthsArr[currentMonthIndex];\n      const nextMonthIndex =\n        currentMonth.name !== 'December' ? currentMonthIndex + 1 : 0;\n\n      if (currentMonth.name === 'February') {\n        currentMonth.daysTotal = isLeapYear(currentYear) ? 29 : 28;\n      }\n      const daysInMonth = currentMonth.daysTotal;\n\n      let currentDay = today.getDate();\n      for (let i = 0; i < 7; i++) {\n        let day =\n          currentDay < daysInMonth\n            ? new Date(currentYear, currentMonthIndex, currentDay)\n            : nextMonthIndex !== 0\n              ? new Date(currentYear, nextMonthIndex, currentDay - daysInMonth)\n              : new Date(nextYear, nextMonthIndex, currentDay - daysInMonth);\n        currentDay++;\n        let tasksDue = filterTasksByDueDate(day);\n        if (tasksDue.length > 0) {\n          filteredArray.push(tasksDue);\n        }\n      }\n      $('#activeListTitle').textContent = 'Upcoming';\n    }\n\n    if (todoAppContainer.classList.contains('show-task-details')) {\n      todoAppContainer.classList.remove('show-task-details');\n    }\n    state.activeList = null;\n    state.filteredList = filteredArray;\n    renderList(filteredArray, listElem);\n\n    $('.is-active-list').classList.remove('is-active-list');\n    listElem.classList.add('is-active-list');\n    formAddTodo.classList.add('is-hidden');\n\n    // Closes sidebar if viewport is < 768px\n    if (document.documentElement.clientWidth < 768) {\n      $('#siteWrapper').classList.remove('show-nav');\n    }\n  }\n\n  function setPriority(e) {\n    if (!e.target.classList.contains('lemon')) return;\n    const id = e.currentTarget.dataset.id;\n    if (state.filteredList !== null) {\n      state.activeList = getListByTaskId(id);\n    }\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    const ulActiveList = $('.is-active-list');\n    const currentTask = state.activeList.getTask(id);\n    const todoItem = currentTask.elem;\n    const taskIndex = state.activeList.findTaskIndex(id);\n    currentTask.isPriority = !currentTask.isPriority;\n    $(`#${id}`).classList.toggle('is-priority');\n\n    if (e.currentTarget.id === 'taskDetailsLemon') {\n      taskDetails.classList.toggle('is-priority');\n    }\n\n    const reverseIndex = state.activeList.tasks\n      .slice()\n      .reverse()\n      .findIndex((task) => task.isPriority && !task.done);\n    const lastIndex = state.activeList.tasks.length - 1;\n    const indexLastPriority =\n      reverseIndex >= 0 ? lastIndex - reverseIndex : reverseIndex;\n\n    // Move priority items to top of list\n    if (currentTask.isPriority === true && !currentTask.done && taskIndex > 0) {\n      state.activeList.tasks.unshift(\n        state.activeList.tasks.splice(taskIndex, 1)[0]\n      );\n      $all('.todo-list__item', ulActiveList).forEach((item, i) => {\n        if (i < taskIndex) {\n          item.style.transform = `translateY(58px)`;\n        } else if (i === taskIndex) {\n          item.style.transform = `translateY(-${item.offsetTop}px)`;\n        }\n      });\n\n      setTimeout(() => {\n        renderList(currentTasksList, ulActiveList);\n        if (todoAppContainer.classList.contains('show-task-details')) {\n          const activeTask = $(`#${hiddenTaskId.value}`);\n          activeTask.classList.add('is-selected');\n        }\n      }, 300);\n    }\n\n    if (\n      !currentTask.isPriority &&\n      !currentTask.done &&\n      taskIndex < indexLastPriority\n    ) {\n      state.activeList.tasks.splice(\n        indexLastPriority,\n        0,\n        state.activeList.tasks.splice(taskIndex, 1)[0]\n      );\n      const itemsBetween = indexLastPriority - taskIndex;\n      todoItem.style.transform = `translateY(${itemsBetween * 58}px)`;\n      for (\n        let i = indexLastPriority;\n        i > indexLastPriority - itemsBetween;\n        i--\n      ) {\n        $all('.todo-list__item', ulActiveList)[\n          i\n        ].style.transform = `translateY(-58px)`;\n      }\n\n      setTimeout(() => {\n        renderList(currentTasksList, ulActiveList);\n        if (todoAppContainer.classList.contains('show-task-details')) {\n          const activeTask = $(`#${hiddenTaskId.value}`);\n          activeTask.classList.add('is-selected');\n        }\n      }, 300);\n    }\n\n    saveToStorage();\n  }\n\n  function toggleMenu() {\n    const siteWrapper = document.getElementById('siteWrapper');\n\n    if (siteWrapper.classList.contains('show-nav')) {\n      siteWrapper.classList.remove('show-nav');\n    } else {\n      siteWrapper.classList.add('show-nav');\n    }\n  }\n\n  function setTagColor(e) {\n    const el = e.target;\n    if (!el.classList.contains('color-picker__swatch')) return;\n    const currentColor = $(`#${el.getAttribute('for')}`);\n    currentColor.checked = true;\n    const tag = colorPicker.parentNode;\n    tag.className = `tag ${currentColor.value}`;\n    const id = colorPicker.dataset.id;\n    const todoItem = state.activeList.tasks.find((task) => task.id === id);\n    const tagIndex = tag.dataset.tagIndex;\n    todoItem.tags[tagIndex].color = currentColor.value;\n    const tagLabel = $all('.tag-label', $(`#${id}`))[tagIndex];\n    tagLabel.className = `tag tag-label ${currentColor.value}`;\n    saveToStorage();\n  }\n\n  function createList(listObj) {\n    const list_ul = createNode('ul', {\n      class: 'todo-list custom-list',\n      id: listObj.id,\n      'data-name': listObj.name\n    });\n    list_ul.addEventListener('click', toggleDone);\n    $('#main').insertBefore(list_ul, formAddTodo);\n    renderListOption(listObj);\n  }\n\n  // Sidebar accordion\n\n  function displayPanel(e) {\n    if (!e.target.classList.contains('accordion__item')) return;\n    const accordion = $('.accordion');\n    const accordionItems = accordion.getElementsByClassName('accordion__item');\n    const selectedPanel = e.currentTarget.querySelector('.accordion__panel');\n    for (let i = 0; i < accordionItems.length; i++) {\n      if (accordionItems[i] === selectedPanel.parentNode) {\n        accordionItems[i].classList.toggle('is-active');\n      }\n    }\n  }\n\n  const createNavItem = (listObj, parentNode = $('#sidebarMenu')) => {\n    const iListIcon = createNode('i', {\n      'data-feather': 'list'\n    });\n    const spanListName = createNode(\n      'span',\n      {\n        class: 'sidebar__list-name'\n      },\n      listObj.name\n    );\n    const spanTaskCount = createNode(\n      'span',\n      {\n        class: 'sidebar__task-count'\n      },\n      listObj.activeTaskCount > 0 ? '' + listObj.activeTaskCount : ''\n    );\n    const aListLink = createNode(\n      'a',\n      {\n        class: `sidebar__link${\n          listObj.activeTaskCount > 0 ? ' has-active-tasks' : ''\n        }`,\n        href: `#${listObj.id}`\n      },\n      iListIcon,\n      spanListName,\n      spanTaskCount\n    );\n    aListLink.addEventListener('click', openList);\n    const liItem = createNode(\n      'li',\n      {\n        class: `${\n          listObj.folder === 'null' ? 'sidebar__item' : 'accordion__sub-item'\n        }`\n      },\n      aListLink\n    );\n    if (listObj.folder === 'null') {\n      parentNode.appendChild(liItem);\n    } else {\n      $(`[data-folder=\"${listObj.folder}\"]`, parentNode).appendChild(liItem);\n    }\n    // Render feather icons\n    feather.replace();\n  };\n\n  function renderNavItems() {\n    // Array of folder names\n    const foldersArr = todoLists\n      .map((list) => list.folder)\n      .filter(\n        (folder, i, arr) => folder !== 'null' && arr.indexOf(folder) === i\n      );\n    const frag = document.createDocumentFragment();\n    foldersArr.forEach((folder) => {\n      const ulFolderPanel = createNode('ul', {\n        class: 'accordion__panel',\n        'data-folder': folder\n      });\n      renderFolderOption(folder);\n      const iFolderIcon = createNode('i', {\n        'data-feather': 'folder'\n      });\n      const iChevronIcon = createNode('i', {\n        class: 'chevron-icon',\n        'data-feather': 'chevron-left'\n      });\n      const liFolder = createNode(\n        'li',\n        {\n          class: 'sidebar__item accordion__item'\n        },\n        iFolderIcon,\n        folder,\n        iChevronIcon,\n        ulFolderPanel\n      );\n\n      liFolder.addEventListener('click', displayPanel);\n      frag.appendChild(liFolder);\n\n      // Creates accordion panel for each folder, with links to children underneath\n      const folderItems = todoLists.filter((list) => list.folder === folder);\n      folderItems.forEach((item) => createNavItem(item, frag));\n    });\n\n    // Creates regular nav items for miscellaneous lists\n    const miscLists = todoLists.filter((list) => list.folder === 'null');\n    miscLists.forEach((item) => {\n      if (item.id !== 'inbox') {\n        createNavItem(item, frag);\n      }\n    });\n    $('#sidebarMenu').appendChild(frag);\n\n    // Render feather icons\n    feather.replace();\n\n    // Displays list on click\n    const navLinksAll = $all('.sidebar__link');\n    navLinksAll.forEach((link) => link.addEventListener('click', openList));\n  }\n\n  renderNavItems();\n\n  function updateTaskCount(listId) {\n    const navLink = $(`.sidebar__link[href=\"#${listId}\"]`);\n    switch (listId) {\n      case 'today':\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const taskCountDueToday = filterTasksByDueDate(today).length;\n        $('.sidebar__task-count', navLink).textContent =\n          taskCountDueToday > 0 ? '' + filterTasksByDueDate(today).length : '';\n        if (taskCountDueToday > 0) {\n          navLink.classList.add('has-active-tasks');\n        } else {\n          navLink.classList.remove('has-active-tasks');\n        }\n        break;\n      case 'upcoming':\n        return;\n        break;\n      case 'filteredList':\n        return;\n        break;\n      default:\n        const listObj = todoLists.find((list) => list.id === listId);\n        $('.sidebar__task-count', navLink).textContent =\n          listObj.activeTaskCount > 0 ? '' + listObj.activeTaskCount : '';\n        if (listObj.activeTaskCount > 0) {\n          navLink.classList.add('has-active-tasks');\n        } else {\n          navLink.classList.remove('has-active-tasks');\n        }\n        break;\n    }\n  }\n\n  function openList(e) {\n    e.preventDefault();\n    const navLinksAll = $all('.sidebar__link');\n    navLinksAll.forEach((link) => {\n      if (link === e.target) {\n        link.classList.add('is-active');\n      } else {\n        link.classList.remove('is-active');\n      }\n    });\n    if (e.target.id !== 'todayNavLink' && e.target.id !== 'upcomingNavLink') {\n      const id = e.target.getAttribute('href').slice(1);\n      const listObj = todoLists.find((list) => list.id === id);\n      displayList(listObj);\n      if (document.documentElement.clientWidth < 768) {\n        $('#siteWrapper').classList.remove('show-nav');\n      }\n    }\n  }\n\n  function renderFolderOption(text) {\n    const folderRadio = createNode('input', {\n      type: 'radio',\n      id: `folder--${camelCased(text)}`,\n      name: 'folder',\n      value: text\n    });\n    const folderLabel = createNode(\n      'label',\n      {\n        class: 'form__label--folder',\n        for: `folder--${camelCased(text)}`\n      },\n      text\n    );\n    const customFolders = $('#fieldsetFolders .custom-folders');\n    customFolders.appendChild(folderRadio);\n    customFolders.appendChild(folderLabel);\n  }\n\n  function renderListOption(listObj) {\n    const listRadio = createNode('input', {\n      type: 'radio',\n      id: `list--${listObj.id}`,\n      name: 'list',\n      value: listObj.id\n    });\n    const listLabel = createNode(\n      'label',\n      {\n        class: 'form__label--list',\n        for: `list--${listObj.id}`\n      },\n      listObj.name\n    );\n    const fieldsetLists = $('#fieldsetLists');\n    fieldsetLists.appendChild(listRadio);\n    fieldsetLists.appendChild(listLabel);\n  }\n\n  function addList(e) {\n    e.preventDefault();\n    const newListName = $('#newListNameInput').value;\n    if (newListName === '') {\n      $('#errorNoListName').classList.add('show-msg');\n    } else {\n      const checkedRadio = $('input[name=\"folder\"]:checked').value;\n      const newFolder = $('#newFolderInput').value;\n      const selectedFolder =\n        checkedRadio !== 'new'\n          ? checkedRadio\n          : newFolder !== ''\n            ? newFolder\n            : 'null';\n      const newList = new List(newListName, selectedFolder);\n      todoLists.push(newList);\n      createList(newList);\n      // Creates new folder accordion element\n      if (newFolder) {\n        const ulFolderPanel = createNode('ul', {\n          class: 'accordion__panel',\n          'data-folder': selectedFolder\n        });\n        const iFolderIcon = createNode('i', {\n          'data-feather': 'folder'\n        });\n        const iChevronIcon = createNode('i', {\n          class: 'chevron-icon',\n          'data-feather': 'chevron-left'\n        });\n        const folder_li = createNode(\n          'li',\n          {\n            class: 'sidebar__item accordion__item'\n          },\n          iFolderIcon,\n          selectedFolder,\n          iChevronIcon,\n          ulFolderPanel\n        );\n        folder_li.addEventListener('click', displayPanel);\n        $('#sidebarMenu').insertBefore(folder_li, $('[data-folder=\"null\"]'));\n\n        renderFolderOption(selectedFolder);\n        feather.replace();\n      }\n      createNavItem(newList);\n      saveToStorage();\n      const navLinksAll = $all('.sidebar__link');\n      navLinksAll.forEach((link) => {\n        if (link.getAttribute('href') === `#${newList.id}`) {\n          link.classList.add('is-active');\n        } else {\n          link.classList.remove('is-active');\n        }\n      });\n      e.currentTarget.reset();\n      $('#newListFormContainer').classList.remove('is-active');\n      if ($('#transferTasksFormContainer').classList.contains('is-active')) {\n        $(`input[name=\"list\"][value=${newList.id}]`).checked = true;\n      } else {\n        displayList(newList);\n      }\n    }\n  }\n\n  function prepEditListForm(e) {\n    // Attach folder options\n    const btnUpdateList = $('#btnUpdateList');\n    formEditList.insertBefore(fieldsetFolders, btnUpdateList);\n    // Insert list name\n    $('#editListNameInput').value = state.activeList.name;\n    // Check radio for list folder\n    $(\n      `input[name=\"folder\"][value=\"${state.activeList.folder}\"]`\n    ).checked = true;\n    $('#editListFormContainer').classList.add('is-active');\n  }\n\n  function updateList(e) {\n    e.preventDefault();\n    const newListName = $('#editListNameInput').value;\n    const checkedRadio = $('input[name=\"folder\"]:checked').value;\n    const selectedFolder =\n      checkedRadio === 'new' ? $('#newFolderInput').value : checkedRadio;\n    const listNavLink = $(`a[href=\"#${state.activeList.id}\"]`);\n    const listNavItem = listNavLink.parentNode;\n    // Rename list\n    if (newListName !== '' && newListName !== state.activeList.name) {\n      state.activeList.name = newListName;\n\n      // Update list nav link\n      $('.sidebar__list-name', listNavLink).textContent = newListName;\n      $('#activeListTitle').textContent = newListName;\n    }\n    // Create new folder\n    if (checkedRadio === 'new' && selectedFolder !== '') {\n      console.log({ selectedFolder });\n      const ulFolderPanel = createNode('ul', {\n        class: 'accordion__panel',\n        'data-folder': selectedFolder\n      });\n      const iFolderIcon = createNode('i', {\n        'data-feather': 'folder'\n      });\n      const folder_li = createNode(\n        'li',\n        {\n          class: 'sidebar__item accordion__item'\n        },\n        iFolderIcon,\n        selectedFolder,\n        ulFolderPanel\n      );\n      folder_li.addEventListener('click', displayPanel);\n      $('#sidebarMenu').insertBefore(folder_li, $('[data-folder=\"null\"]'));\n\n      renderFolderOption(selectedFolder);\n      feather.replace();\n    }\n    // Set different/new folder\n    if (state.activeList.folder !== selectedFolder && selectedFolder !== '') {\n      state.activeList.folder = selectedFolder;\n\n      // Append list nav item to sidebar\n      if (selectedFolder === 'null') {\n        listNavItem.className = 'sidebar__item';\n        listNavItem.dataset.folder = 'null';\n        $('#sidebarMenu').appendChild(listNavItem);\n      } else {\n        // Append list nav item to different/new folder\n        listNavItem.className = 'accordion__sub-item';\n        listNavItem.removeAttribute('data-folder');\n        $(`[data-folder=\"${selectedFolder}\"]`).appendChild(listNavItem);\n      }\n    }\n    // Save changes to storage\n    saveToStorage();\n    e.currentTarget.reset();\n    $('#editListFormContainer').classList.remove('is-active');\n  }\n\n  function deleteList(listObj) {\n    const listNavLink = $(`a[href=\"#${listObj.id}\"]`);\n    const listNavItem = listNavLink.parentNode;\n    const listElement = listObj.elem;\n\n    // Delete list object\n    const listIndex = todoLists.indexOf(listObj);\n    todoLists.splice(listIndex, 1);\n    saveToStorage();\n\n    // Delete list nav item\n    listNavItem.remove();\n\n    // Delete folder elements if list is the only item in folder\n    const folder = listObj.folder;\n    if (\n      folder !== 'null' &&\n      todoLists.filter((list) => list.folder === folder).length === 0\n    ) {\n      // Delete nav folder item\n      $(`[data-folder=\"${listObj.folder}\"]`).parentNode.remove();\n      // Delete folder radio\n      const folderRadio = $(`input[name=\"folder\"][value=\"${folder}\"]`);\n      folderRadio.remove();\n      $(`.form__label--folder[for=${folderRadio.id}]`).remove();\n    }\n\n    // Delete list `ul` element\n    listElement.remove();\n\n    // Delete list option from transfer tasks form\n    const listRadio = $(`input[name=\"list\"][value=${listObj.id}]`);\n    listRadio.remove();\n    $(`.form__label--list[for=${listRadio.id}]`).remove();\n\n    // Reload inbox\n    const inbox = todoLists.find((list) => list.name === 'Inbox');\n    displayList(inbox);\n\n    if ($('#alertWarningDeleteList').classList.contains('is-active')) {\n      $('#alertWarningDeleteList').classList.remove('is-active');\n    }\n  }\n\n  function displayList(listObj) {\n    const ulActiveList = $('.is-active-list');\n    const list_ul = $(`#${listObj.id}`);\n\n    // Updates state\n    state.activeList = listObj;\n    state.filteredList = null;\n\n    if ($('#bulkActionsToolbar').classList.contains('is-active')) {\n      $('#bulkActionsToolbar').classList.remove('is-active');\n      ulActiveList.removeEventListener('click', enableBulkActions);\n      $('#main').removeEventListener('scroll', stickToolbar);\n      ulActiveList.classList.remove('bulk-editing-list');\n    }\n\n    if ($('#main').classList.contains('show-search-results')) {\n      $('#main').classList.remove('show-search-results');\n    }\n\n    if (todoAppContainer.classList.contains('show-task-details')) {\n      todoAppContainer.classList.remove('show-task-details');\n    }\n\n    $('#activeListTitle').textContent = listObj.name;\n    populateList(listObj.tasks, list_ul);\n\n    $all('.todo-list').forEach((x) => {\n      if (x !== list_ul) {\n        x.classList.remove('is-active-list');\n      } else {\n        x.classList.add('is-active-list');\n      }\n    });\n    formAddTodo.classList.remove('is-hidden');\n  }\n\n  function populateCalendarYears() {\n    const date = new Date();\n    const year = date.getFullYear();\n    const frag = document.createDocumentFragment();\n    // Adds current and next 2 years as radio options for year picker\n    for (let i = 0; i <= 3; i++) {\n      const yearRadio = createNode('input', {\n        type: 'radio',\n        name: 'year',\n        value: `${year + i}`,\n        id: `${year + i}`,\n        class: 'dp-calendar__radio'\n      });\n      frag.appendChild(yearRadio);\n      const yearLabel = createNode(\n        'label',\n        {\n          for: `${year + i}`,\n          class: 'dp-calendar__year'\n        },\n        `${year + i}`\n      );\n      frag.appendChild(yearLabel);\n    }\n    $('#dpCalendarYearDropdown').appendChild(frag);\n  }\n\n  populateCalendarYears();\n\n  // Sets default month to current month\n\n  function updateDateInput(dateComponent, ...newValues) {\n    const currentDate = $('#inputDueDate').value; // `mm/dd/yy`\n    const currentYear = currentDate.slice(6);\n    const currentMonth = currentDate.slice(0, 2);\n    const currentDay = currentDate.slice(3, 5);\n    switch (dateComponent) {\n      case 'month':\n        const monthNum = monthsArr.findIndex((x) => x.name === newValues[0]);\n        $('#inputDueDate').value = `${\n          monthNum > 8 ? monthNum + 1 : `0${monthNum + 1}`\n        }/${currentDay}/${currentYear}`;\n        break;\n      case 'day':\n        $('#inputDueDate').value = `${currentMonth}/${\n          newValues[0] > 9 ? newValues[0] : `0${newValues[0]}`\n        }/${currentYear}`;\n        break;\n      case 'year':\n        $(\n          '#inputDueDate'\n        ).value = `${currentMonth}/${currentDay}/${newValues[0].slice(2)}`;\n        break;\n      case 'all':\n        const monthIndex = monthsArr.findIndex((x) => x.name === newValues[0]);\n        $('#inputDueDate').value = `${\n          monthIndex > 8 ? monthIndex + 1 : `0${monthIndex + 1}`\n        }/${\n          newValues[1] > 9 ? newValues[1] : `0${newValues[1]}`\n        }/${newValues[2].slice(2)}`;\n        break;\n    }\n  }\n\n  function selectMonth(e) {\n    if (!e.target.classList.contains('dp-calendar__month')) return;\n    const currentDueDate = $('#inputDueDate').value; // mm-dd-yy\n    const dueMonthIndex = +currentDueDate.slice(0, 2) - 1;\n    const dueMonth = monthsArr[dueMonthIndex].name;\n    const dueDay = +currentDueDate.slice(3, 5);\n\n    const prevSelectedMonth = $('input[name=\"month\"]:checked').value;\n    const monthDropdown = $('#dpCalendarMonthDropdown');\n    const btnToggleMonthDropdown = $('#btnToggleMonthDropdown');\n    const radioId = e.target.getAttribute('for');\n    const radio = $(`#${radioId}`);\n    radio.checked = true;\n    const selectedMonth = radio.value;\n    if (selectedMonth !== prevSelectedMonth) {\n      $('#btnToggleMonthDropdown .btn-text').textContent = selectedMonth;\n      populateCalendarDays(selectedMonth);\n\n      if (selectedMonth === dueMonth) {\n        $(\n          `.dp-calendar__btn--select-day[value=\"${dueDay}\"][data-month=\"${selectedMonth}\"]`\n        ).classList.add('is-selected');\n      }\n    }\n    btnToggleMonthDropdown.classList.remove('is-active');\n    monthDropdown.classList.remove('is-active');\n  }\n\n  function selectYear(e) {\n    if (!e.target.classList.contains('dp-calendar__year')) return;\n\n    const currentDueDate = $('#inputDueDate').value; // mm-dd-yy\n    const dueMonthIndex = +currentDueDate.slice(0, 2) - 1;\n    const dueMonth = monthsArr[dueMonthIndex].name;\n    const dueDay = +currentDueDate.slice(3, 5);\n    const dueYear = `20${currentDueDate.slice(6)}`;\n\n    const prevSelectedYear = $('input[name=\"year\"]:checked').value;\n    const btnToggleYearDropdown = $('#btnToggleYearDropdown');\n    const yearDropdown = $('#dpCalendarYearDropdown');\n    const radioId = e.target.getAttribute('for');\n    const radio = $(`#${radioId}`);\n    radio.checked = true;\n    const selectedYear = radio.value;\n\n    if (selectedYear !== prevSelectedYear) {\n      $('#btnToggleYearDropdown .btn-text').textContent = selectedYear;\n      populateCalendarDays(dueMonth);\n\n      // Length of February depends on leap year\n      if (selectedYear === dueYear) {\n        $(\n          `.dp-calendar__btn--select-day[value=\"${dueDay}\"][data-month=\"${dueMonth}\"]`\n        ).classList.add('is-selected');\n      }\n    }\n    btnToggleYearDropdown.classList.remove('is-active');\n    yearDropdown.classList.remove('is-active');\n  }\n\n  function populateCalendarDays(monthStr) {\n    while ($('#dpCalendar').contains($('.dp-calendar__day'))) {\n      $('.dp-calendar__day').remove();\n    }\n\n    const year = $('input[name=\"year\"]:checked').value;\n    const monthIndex = monthsArr.findIndex((month) => month.name === monthStr);\n    const month = monthsArr[monthIndex];\n    const monthStartingDate = new Date(year, monthIndex, 1);\n    const monthStartingDayNum = monthStartingDate.getDay();\n    const prevMonth =\n      monthIndex !== 0 ? monthsArr[monthIndex - 1] : monthsArr[11];\n    const nextMonth =\n      monthIndex !== 11 ? monthsArr[monthIndex + 1] : monthsArr[0];\n\n    if (monthStr === 'February') {\n      month.daysTotal = isLeapYear(year) ? 29 : 28;\n    }\n\n    const frag = document.createDocumentFragment();\n\n    if (monthStartingDayNum !== 0) {\n      for (\n        let j = prevMonth.daysTotal - monthStartingDayNum + 1;\n        j <= prevMonth.daysTotal;\n        j++\n      ) {\n        const btnDay = createNode(\n          'button',\n          {\n            class: 'dp-calendar__btn--select-day dp-calendar__btn--prev-month',\n            type: 'button',\n            'data-month': prevMonth.name,\n            'data-year': prevMonth.name === 'December' ? +year - 1 : year,\n            'data-action': 'selectDay',\n            value: j\n          },\n          `${j}`\n        );\n        const divDay = createNode(\n          'div',\n          {\n            class: 'dp-calendar__day dp-calendar__day--prev-month'\n          },\n          btnDay\n        );\n        frag.appendChild(divDay);\n      }\n    }\n\n    for (let i = 1; i <= month.daysTotal; i++) {\n      const btnDay = createNode(\n        'button',\n        {\n          class: 'dp-calendar__btn--select-day',\n          type: 'button',\n          'data-month': month.name,\n          'data-year': year,\n          'data-action': 'selectDay',\n          'data-first': i === 1,\n          'data-last': i === month.daysTotal,\n          value: i\n        },\n        `${i}`\n      );\n      const divDay = createNode(\n        'div',\n        {\n          class: 'dp-calendar__day'\n        },\n        btnDay\n      );\n      frag.appendChild(divDay);\n    }\n\n    if (frag.children.length % 7 !== 0) {\n      for (let k = 1; k < 7; k++) {\n        const btnDay = createNode(\n          'button',\n          {\n            class: 'dp-calendar__btn--select-day dp-calendar__btn--next-month',\n            type: 'button',\n            'data-month': nextMonth.name,\n            'data-year': nextMonth.name === 'January' ? +year + 1 : year,\n            'data-action': 'selectDay',\n            value: k\n          },\n          `${k}`\n        );\n        const divDay = createNode(\n          'div',\n          {\n            class: 'dp-calendar__day dp-calendar__day--next-month'\n          },\n          btnDay\n        );\n        frag.appendChild(divDay);\n        if (frag.children.length % 7 === 0) {\n          break;\n        }\n      }\n    }\n\n    $('#dpCalendarDayPicker').appendChild(frag);\n  }\n\n  function selectDay(e) {\n    const el = e.target;\n    if (el.dataset.action !== 'selectDay') return;\n\n    $all('.dp-calendar__btn--select-day').forEach((x) => {\n      if (x === el) {\n        x.classList.add('is-selected');\n      } else {\n        x.classList.remove('is-selected');\n      }\n    });\n    const selectedDay = el.value;\n    const selectedMonth = el.dataset.month;\n    const selectedYear = el.dataset.year;\n    updateDateInput('all', selectedMonth, selectedDay, selectedYear);\n\n    if (\n      el.classList.contains('dp-calendar__btn--prev-month') ||\n      el.classList.contains('dp-calendar__btn--next-month')\n    ) {\n      if (\n        (el.classList.contains('dp-calendar__btn--prev-month') &&\n          selectedMonth === 'December') ||\n        (el.classList.contains('dp-calendar__btn--next-month') &&\n          selectedMonth === 'January')\n      ) {\n        $(`input[name=\"year\"][value=\"${selectedYear}\"]`).checked = true;\n        $('#btnToggleYearDropdown .btn-text').textContent = selectedYear;\n      }\n\n      $(`input[name=\"month\"][value=\"${selectedMonth}\"]`).checked = true;\n      $('#btnToggleMonthDropdown .btn-text').textContent = selectedMonth;\n      populateCalendarDays(selectedMonth);\n      $(\n        `.dp-calendar__btn--select-day[value=\"${selectedDay}\"][data-month=\"${selectedMonth}\"]`\n      ).classList.add('is-selected');\n    }\n  }\n\n  function setDueDate(e) {\n    const id = hiddenTaskId.value;\n    const currentTask = state.activeList.getTask(id);\n    const todoItem = currentTask.elem;\n\n    const dueDate = $('#inputDueDate').value; // `mm/dd/yy`\n    const dueYear = +`20${dueDate.slice(6)}`;\n    const dueMonthIndex = +dueDate.slice(0, 2) - 1;\n    const dueDay = +dueDate.slice(3, 5);\n    const dueMonthAbbrev = monthsArr[dueMonthIndex].abbrev;\n    const currentDueDate = new Date(currentTask.dueDate);\n    const newDueDate = new Date(dueYear, dueMonthIndex, dueDay);\n\n    if (currentDueDate.valueOf() !== newDueDate.valueOf()) {\n      currentTask.dueDate = newDueDate;\n      saveToStorage();\n      const dueDateLabel = $('.badge--due-date', todoItem)\n        ? $('.badge--due-date', todoItem)\n        : createNode('span');\n\n      if (currentTask.isDueToday) {\n        dueDateLabel.textContent = 'Today';\n        dueDateLabel.className = 'badge--due-date badge--today';\n        updateTaskCount('today');\n      } else if (currentTask.isDueTomorrow) {\n        dueDateLabel.textContent = 'Tomorrow';\n        dueDateLabel.className = 'badge--due-date badge--tomorrow';\n      } else {\n        dueDateLabel.className = 'badge--due-date';\n        dueDateLabel.textContent = currentTask.dueDateText;\n      }\n\n      if (!$('.badge--due-date', todoItem)) {\n        todoItem.appendChild(dueDateLabel);\n      }\n      todoItem.classList.add('show-info');\n    }\n\n    $('#dueDateWrapper').classList.add('has-due-date');\n    $('#dueDateWrapper .due-date-text').textContent = currentTask.dueDateText;\n    $('#dueDateWrapper').classList.remove('show-input');\n    $('#dueDateWrapper').parentNode.classList.remove('is-focused');\n    $('#dpCalendar').classList.remove('is-active');\n  }\n\n  function closeModal(e) {\n    if (!e.target.classList.contains('modal__btn--close')) return;\n    e.currentTarget.classList.remove('is-active');\n    const errors = $all('.error', e.currentTarget);\n    errors.forEach((error) => {\n      if (error.classList.contains('show-msg')) {\n        error.classList.remove('show-msg');\n      }\n    });\n    const form = $('form', e.currentTarget);\n    if (e.currentTarget.contains(form)) {\n      form.reset();\n    }\n  }\n\n  function closeTooltip(e) {\n    if (!e.target.classList.contains('tooltip__btn--close')) return;\n    e.currentTarget.classList.remove('show-tooltip');\n    if (e.currentTarget.classList.contains('onboarding__tooltip')) {\n      $('#onboarding').classList.add('is-active');\n    }\n  }\n\n  function hideError(e) {\n    if (!e.target.classList.contains('error__btn--hide')) return;\n    e.currentTarget.classList.remove('show-msg');\n  }\n\n  function initDpCalendar(e) {\n    if (e.currentTarget.classList.contains('show-input')) return;\n\n    const id = $('#dpCalendar').parentNode.dataset.id;\n    const currentTask = state.activeList.tasks.find((task) => task.id === id);\n\n    if (currentTask.dueDate !== null) {\n      const dueDate = new Date(currentTask.dueDate);\n      // month index starts at 0\n      const dueMonthIndex = dueDate.getMonth();\n      const dueMonth = monthsArr[dueMonthIndex].name;\n      const dueDay = dueDate.getDate();\n      const dueYear = `${dueDate.getFullYear()}`;\n\n      updateDateInput('all', dueMonth, dueDay, dueYear);\n\n      $(`input[name=\"year\"][value=\"${dueYear}\"]`).checked = true;\n      $('#btnToggleYearDropdown .btn-text').textContent = dueYear;\n      $(`input[name=\"month\"][value=\"${dueMonth}\"]`).checked = true;\n      $('#btnToggleMonthDropdown .btn-text').textContent = dueMonth;\n      populateCalendarDays(dueMonth);\n      $(\n        `.dp-calendar__btn--select-day[value=\"${dueDay}\"][data-month=\"${dueMonth}\"]`\n      ).classList.add('is-selected');\n    } else {\n      const now = new Date();\n      const currentMonthNum = now.getMonth();\n      const currentMonth = monthsArr[currentMonthNum];\n      const currentYear = `${now.getFullYear()}`;\n      const currentDay = now.getDate();\n      updateDateInput('all', currentMonth.name, currentDay, currentYear);\n\n      // Set default month to current month\n      $(\n        `#dpCalendarMonthDropdown input[value=\"${currentMonth.name}\"]`\n      ).checked = true;\n      $('#btnToggleMonthDropdown .btn-text').textContent = currentMonth.name;\n\n      // Sets default year to current year\n      $(`#dpCalendarYearDropdown input[value=\"${currentYear}\"]`).checked = true;\n      $('#btnToggleYearDropdown .btn-text').textContent = currentYear;\n      populateCalendarDays(currentMonth.name);\n      $(\n        `.dp-calendar__btn--select-day[value=\"${currentDay}\"][data-month=\"${\n          currentMonth.name\n        }\"]`\n      ).classList.add('is-selected');\n    }\n  }\n\n  function expandSearchBar(e) {\n    e.stopPropagation();\n    if (e.target === searchInput) return;\n    if (!searchBar.classList.contains('is-expanded')) {\n      e.preventDefault();\n      searchBar.classList.add('is-expanded');\n      $('#searchInput').focus();\n    } else if (\n      searchBar.classList.contains('is-expanded') &&\n      searchInput.value == ''\n    ) {\n      searchBar.classList.remove('is-expanded');\n    }\n  }\n\n  // Disables/Enables bulk action buttons, depending on if items are checked\n  function enableBulkActions(e) {\n    const ulActiveList = $('.is-active-list');\n    const checkedItems = $all('.bulk-actions__checkbox:checked', ulActiveList);\n    const allItems = $all('.bulk-actions__checkbox', ulActiveList);\n    const bulkActions = $all('.toolbar__btn[data-bulk-action=\"true\"]');\n    const masterCheckbox = $('#masterCheckbox');\n    // If no items are selected...\n    if (checkedItems.length === 0) {\n      // Disable bulk action buttons\n      bulkActions.forEach((btn) => (btn.disabled = true));\n      // Uncheck master checkbox\n      if (masterCheckbox.checked === true) {\n        masterCheckbox.checked = false;\n      }\n    } else {\n      // Enable bulk action buttons\n      bulkActions.forEach((btn) => (btn.disabled = false));\n      // If all items are selected, change state of master checkbox to true if unchecked\n      if (\n        checkedItems.length === allItems.length &&\n        masterCheckbox.checked === false\n      ) {\n        masterCheckbox.checked = true;\n      }\n    }\n  }\n\n  function initBulkEditing(e) {\n    // Hide add todo form\n    $('#addTodoForm').classList.add('is-hidden');\n    // Uncheck master bulk editing checkbox\n    $('#masterCheckbox').checked = false;\n    // Reveal bulk editing toolbar\n    $('#bulkActionsToolbar').classList.add('is-active');\n    // Add bulk-editing checkboxes and hide regular checkboxes for toggling completeness\n    const ulActiveList = $('.is-active-list');\n    ulActiveList.classList.add('bulk-editing-list');\n    $all('.todo-list__item', ulActiveList).forEach((x, i) => {\n      const frag = document.createDocumentFragment();\n      const checkbox = createNode('input', {\n        type: 'checkbox',\n        id: `bulk-item-${i}`,\n        'data-index': i,\n        'data-id': x.id,\n        class: 'bulk-actions__checkbox'\n      });\n      checkbox.addEventListener('change', highlightSelected);\n      const checkboxLabel = createNode('label', {\n        class: 'bulk-actions__checkbox-label',\n        for: `bulk-item-${i}`\n      });\n      frag.appendChild(checkbox);\n      frag.appendChild(checkboxLabel);\n      x.insertBefore(frag, $('input[type=\"checkbox\"]', x));\n      $('.todo-list__checkbox', x).classList.add('is-hidden');\n      x.classList.add('bulk-editing-list__item');\n    });\n    // Disable bulk action buttons\n    $all('.toolbar__btn[data-bulk-action=\"true\"]').forEach(\n      (btn) => (btn.disabled = true)\n    );\n    ulActiveList.addEventListener('click', enableBulkActions);\n    $('#main').addEventListener('scroll', stickToolbar);\n  }\n\n  function highlightSelected(e) {\n    const todoItem = e.currentTarget.parentNode;\n    if (e.currentTarget.checked === true) {\n      todoItem.classList.add('is-checked');\n    } else {\n      todoItem.classList.remove('is-checked');\n    }\n  }\n\n  function transferTasks(e) {\n    e.preventDefault();\n    const ulActiveList = $('.is-active-list');\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    const checkedItems = $all('.bulk-actions__checkbox:checked', ulActiveList);\n    const newListId = $('input[name=\"list\"]:checked').value;\n    const newListObj = todoLists.find((list) => list.id === newListId);\n\n    // Remove tasks from current list and add to new list\n    checkedItems.forEach((item) => {\n      const taskId = item.dataset.id;\n      const listObj = getListByTaskId(taskId);\n      const taskIndex = listObj.tasks.findIndex((task) => task.id === taskId);\n      const task = listObj.tasks.splice(taskIndex, 1)[0];\n      newListObj.tasks.unshift(task);\n    });\n\n    saveToStorage();\n\n    // Update task count\n    updateTaskCount(newListObj.id);\n    updateTaskCount(ulActiveList.id);\n    // Reload current list to reflect changes\n    renderList(currentTasksList, ulActiveList);\n    $('#transferTasksFormContainer').classList.remove('is-active');\n  }\n\n  function deleteSelected(e) {\n    e.preventDefault();\n    const ulActiveList = $('.is-active-list');\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    const checkedItems = $all('.bulk-actions__checkbox:checked', ulActiveList);\n    checkedItems.forEach((item) => {\n      listObj = getListByTaskId(item.dataset.id);\n      deleteTask(listObj, item.dataset.id);\n    });\n    if (ulActiveList.id === 'upcoming') {\n      displayTaskSchedule('upcoming', $('#upcoming'));\n    } else if (ulActiveList.id === 'today') {\n      displayTaskSchedule('today', $('#today'));\n    } else {\n      renderList(currentTasksList, ulActiveList);\n    }\n  }\n\n  // Hides certain elements if you click outside of them\n  function hideComponents(e) {\n    if (\n      colorPicker.classList.contains('is-visible') &&\n      e.target !== $('#btnAddTag') &&\n      e.target !== colorPicker &&\n      !colorPicker.contains(e.target)\n    ) {\n      colorPicker.classList.remove('is-visible');\n      formEditTodo.appendChild(colorPicker);\n    }\n\n    // Hides tag labels tooltip\n    if (\n      divTodoApp.contains($('.tag-labels__btn--tooltip.show-tooltip')) &&\n      e.target !== $('.tag-labels__btn--tooltip.show-tooltip')\n    ) {\n      $('.tag-labels__btn--tooltip.show-tooltip').classList.remove(\n        'show-tooltip'\n      );\n    }\n\n    const monthDropdown = $('#dpCalendarMonthDropdown');\n    const btnToggleMonthDropdown = $('#btnToggleMonthDropdown');\n    const yearDropdown = $('#dpCalendarYearDropdown');\n    const btnToggleYearDropdown = $('#btnToggleYearDropdown');\n\n    // Hides monthDropdown\n    if (\n      monthDropdown.classList.contains('is-active') &&\n      e.target !== monthDropdown &&\n      e.target !== btnToggleMonthDropdown &&\n      !monthDropdown.contains(e.target)\n    ) {\n      monthDropdown.classList.remove('is-active');\n      btnToggleMonthDropdown.classList.remove('is-active');\n    }\n\n    // Hides yearDropdown\n    if (\n      yearDropdown.classList.contains('is-active') &&\n      e.target !== yearDropdown &&\n      e.target !== btnToggleYearDropdown &&\n      !yearDropdown.contains(e.target)\n    ) {\n      yearDropdown.classList.remove('is-active');\n      btnToggleYearDropdown.classList.remove('is-active');\n    }\n\n    // Hides searchBar input\n    if (\n      (searchBar.classList.contains('is-expanded') &&\n        ((searchInput.value === '' &&\n          e.target !== searchBar &&\n          !searchBar.contains(e.target)) ||\n          e.target.classList.contains('sidebar__link') ||\n          e.target.classList.contains('filtered-list__link'))) ||\n      e.target.classList.contains('breadcrumbs__link')\n    ) {\n      formSearch.reset();\n      inputSearch.blur();\n      searchBar.classList.remove('is-expanded');\n    }\n\n    // Hides dropdown menus\n    $all('.more-actions__wrapper').forEach((item) => {\n      if (\n        item.classList.contains('show-actions') &&\n        e.target !== item &&\n        !item.contains(e.target)\n      ) {\n        item.classList.remove('show-actions');\n      }\n    });\n  }\n\n  function continueTour(e) {\n    const el = e.target;\n    if (!el.classList.contains('onboarding__btn')) return;\n    const modal = e.currentTarget;\n    const action = el.dataset.action;\n    const ulActiveList = $('.is-active-list');\n\n    if (action === 'beginTour') {\n      $('.onboarding__footer', modal).classList.add('is-active');\n      // Refresh completion status for all steps if tour is retaken\n      $all('.onboarding__stepper .stepper__btn').forEach((btn) =>\n        btn.classList.remove('is-completed')\n      );\n      state.onboarding.statusLog.forEach((status, i, arr) => (arr[i] = false));\n      state.onboarding.currentStep = 0;\n    }\n\n    const currentStep = state.onboarding.currentStep;\n    const nextStep = state.onboarding.nextStep;\n\n    if (action === 'endTour') {\n      state.onboarding.currentStep = null;\n      // Delete dummy tasks created in Step 3\n      const noDummyTasks = state.activeList.tasks.filter(\n        (task) => task.text !== 'Delete Me!'\n      );\n      state.activeList.tasks = noDummyTasks;\n      renderList(state.activeList.tasks, ulActiveList);\n      $all('.onboarding__step').forEach((section) => {\n        let step = +section.dataset.onboardingStep;\n        if (step === 0) {\n          section.classList.add('is-active');\n        } else {\n          section.classList.remove('is-active');\n        }\n      });\n      $('.onboarding__footer', modal).classList.remove('is-active');\n    } else {\n      if (action === 'activateTooltips') {\n        modal.classList.remove('is-active');\n        if (currentStep === 1) {\n          formAddTodo.appendChild($('#onboardingTooltip_1-1'));\n        }\n        $(\n          `.onboarding__tooltip[data-onboarding-step=\"${currentStep}\"][data-order=\"0\"]`\n        ).classList.add('show-tooltip');\n        const target = $(`[data-onboarding-target=\"${currentStep}\"]`);\n        // Set up first interaction point for current onboarding step\n        if (target.tagName === 'FORM') {\n          target.addEventListener('submit', trackTourProgress);\n        } else {\n          target.addEventListener('click', trackTourProgress);\n        }\n      } else {\n        console.log({ nextStep });\n        // Show next section\n        $all('.onboarding__step').forEach((section) => {\n          let step = +section.dataset.onboardingStep;\n          if (step === nextStep) {\n            section.classList.add('is-active');\n          } else {\n            section.classList.remove('is-active');\n          }\n        });\n\n        // Set stepper btn to active\n\n        $all('.onboarding__stepper .stepper__btn').forEach((btn, i) => {\n          if (i === nextStep - 1) {\n            btn.classList.add('is-active');\n          } else {\n            btn.classList.remove('is-active');\n          }\n        });\n        // Updates state, looping the tour back to the beginning, if it reaches the end (step 4)\n        state.onboarding.currentStep = state.onboarding.nextStep;\n      }\n    }\n  }\n\n  function trackTourProgress(e) {\n    console.log(state.onboarding.nextStep);\n    const target = e.currentTarget;\n    const tooltip = $('.onboarding__tooltip.show-tooltip');\n    const currentStep = state.onboarding.currentStep;\n    const ulActiveList = $('.is-active-list');\n    const tooltipSet = Array.prototype.slice\n      .call($all(`.onboarding__tooltip[data-onboarding-step=\"${currentStep}\"]`))\n      .sort((a, b) => {\n        return +a.dataset.order - +b.dataset.order;\n      });\n\n    target.removeEventListener(e.type, trackTourProgress);\n\n    if (currentStep === null) return;\n\n    // Set up interaction points\n    /**\n     * Step 1\n     */\n    // Part 1\n    if (target === formAddTodo) {\n      // Attach tooltip for Step 2 to first todo item\n      const firstTask = $('.is-active-list .todo-list__item');\n      firstTask.appendChild($('#onboardingTooltip_1-2'));\n      firstTask.addEventListener('click', trackTourProgress);\n    }\n    // Part 2\n    if (target.classList.contains('todo-list__item')) {\n      $('.task-details__header').appendChild($('#onboardingTooltip_1-3'));\n      $('#btnCloseTaskDetails').addEventListener('click', trackTourProgress);\n    }\n\n    /**\n     *  Step 2\n     */\n    // Part 1\n    if (target.classList.contains('sidebar__btn--toggle-open')) {\n      $('.sidebar__buttons').insertBefore(\n        $('#onboardingTooltip_2-2'),\n        $('#helpActionsWrapper')\n      );\n      $('#openListFormBtn').addEventListener('click', trackTourProgress);\n    }\n\n    // Part 2\n\n    if (target === $('#openListFormBtn')) {\n      $('#fieldsetNewListInput').appendChild($('#onboardingTooltip_2-3'));\n      $('#newListNameInput').addEventListener('input', trackTourProgress);\n    }\n\n    // Part 3\n    if (target === $('#newListNameInput')) {\n      $('#fieldsetFolders').appendChild($('#onboardingTooltip_2-4'));\n      $('#newListForm').addEventListener('submit', trackTourProgress);\n    }\n\n    // Part 4\n\n    if (target === $('#newListForm')) {\n      $('#listActionsWrapper').appendChild($('#onboardingTooltip_3-1'));\n    }\n\n    /**\n     *  Step 3\n     */\n    // Part 1\n    if (target.classList.contains('list-actions__btn--toggle')) {\n      $('#bulkActionsToolbar').appendChild($('#onboardingTooltip_3-2'));\n      $('#onboardingTooltip_3-2').classList.add('show-tooltip');\n      $('#btnInitBulkEditing').addEventListener('click', trackTourProgress);\n    }\n    // Part 2\n\n    if (target === $('#btnInitBulkEditing')) {\n      // Create dummy tasks for user to delete\n      for (let i = 0; i < 3; i++) {\n        let dummyTask = new Task('Delete Me!');\n        state.activeList.tasks.push(dummyTask);\n      }\n      populateList(state.activeList.tasks, ulActiveList);\n      $('#masterCheckbox').addEventListener('change', trackTourProgress);\n      return;\n    }\n\n    if (target === $('#masterCheckbox')) {\n      $('#bulkActionsToolbar').appendChild($('#onboardingTooltip_3-3'));\n      $('#btnDeleteSelected').addEventListener('click', trackTourProgress);\n    }\n\n    // Close active tooltip\n    tooltip.classList.remove('show-tooltip');\n    // Ensure tooltip doesn't get deleted\n    divTodoApp.appendChild(tooltip);\n\n    // If current tooltip is not the last one in the set, activate the next one\n    if (tooltip !== tooltipSet[tooltipSet.length - 1]) {\n      tooltipSet.forEach((item, i, arr) => {\n        if (item === tooltip) {\n          arr[i + 1].classList.add('show-tooltip');\n        }\n      });\n      return;\n    }\n\n    const nextStep = state.onboarding.nextStep;\n\n    // Mark step as completed\n    $all('.onboarding__stepper .stepper__btn').forEach((btn, i) => {\n      if (i === currentStep - 1) {\n        btn.classList.remove('is-active');\n        btn.classList.add('is-completed');\n      } else if (i === nextStep - 1) {\n        btn.classList.add('is-active');\n      }\n    });\n\n    // Update step status\n    state.onboarding.updateStatus = true;\n    if (state.onboarding.isCompleted) {\n      $('.onboarding__footer').classList.remove('is-active');\n    }\n\n    // Proceed to next step of tour\n    $all('.onboarding__step').forEach((section, i) => {\n      if (i === state.onboarding.nextStep) {\n        section.classList.add('is-active');\n      } else {\n        section.classList.remove('is-active');\n      }\n    });\n\n    console.log(state.onboarding.currentStep);\n    console.log(state.onboarding.nextStep);\n\n    // Reopen modal\n    $('#onboarding').classList.add('is-active');\n\n    // Update state\n    state.onboarding.currentStep = state.onboarding.nextStep;\n  }\n\n  function selectStep(e) {\n    $all('.onboarding__stepper .stepper__btn').forEach((btn, i) => {\n      if (e.target === btn) {\n        state.onboarding.currentStep = i + 1;\n        console.log(state.onboarding.currentStep);\n        console.log(state.onboarding.nextStep);\n\n        $all('.onboarding__step').forEach((section) => {\n          let step = +section.dataset.onboardingStep;\n          if (step === state.onboarding.currentStep) {\n            section.classList.add('is-active');\n          } else {\n            section.classList.remove('is-active');\n          }\n        });\n        btn.classList.add('is-active');\n      } else {\n        btn.classList.remove('is-active');\n      }\n    });\n  }\n\n  function stickToolbar(e) {\n    const toolbar = $('#bulkActionsToolbar');\n    const main = $('#main');\n    if (main.scrollTop >= toolbar.offsetTop) {\n      main.classList.add('sticky-toolbar');\n    } else {\n      main.classList.remove('sticky-toolbar');\n    }\n  }\n\n  // Event Listeners\n\n  $('#newListNameInput').addEventListener('input', (e) => {\n    if ($('#errorNoListName').classList.contains('show-msg')) {\n      $('#errorNoListName').classList.remove('show-msg');\n    }\n  });\n\n  $('#taskDetailsBreadcrumbs .breadcrumbs__link').addEventListener(\n    'click',\n    openList\n  );\n\n  $('#taskDetailsLemon').addEventListener('click', setPriority);\n\n  $('#taskName').addEventListener('input', enableAutoHeightResize);\n  $('#todoItemNote').addEventListener('input', enableAutoHeightResize);\n\n  $('#btnCloseTaskDetails').addEventListener('click', toggleContent);\n\n  $('#taskName').addEventListener('change', renameTodo);\n\n  const stepper = $('.onboarding__stepper');\n  $all('.stepper__btn', stepper).forEach((btn) =>\n    btn.addEventListener('click', selectStep)\n  );\n\n  $('#onboarding').addEventListener('click', continueTour);\n\n  $('#transferTasksForm').addEventListener('submit', transferTasks);\n\n  $('#newListInput').addEventListener('click', (e) => {\n    $('input[id=\"listNew\"]').checked = true;\n  });\n\n  $('#bulkActionsToolbar').addEventListener('click', (e) => {\n    const el = e.target;\n    const ulActiveList = $('.is-active-list');\n    const currentListObj = state.activeList;\n    const currentTasksList =\n      state.filteredList === null ? state.activeList.tasks : state.filteredList;\n    if (el.dataset.action === 'transferSelected') {\n      $('#transferTasksFormContainer').classList.add('is-active');\n    } else if (el.dataset.action === 'deleteSelected') {\n      deleteSelected(e);\n    } else if (el.dataset.action === 'closeBulkActionsToolbar') {\n      ulActiveList.removeEventListener('click', enableBulkActions);\n      $('#main').removeEventListener('scroll', stickToolbar);\n      ulActiveList.classList.remove('bulk-editing-list');\n      renderList(currentTasksList, ulActiveList);\n    }\n  });\n\n  $('#masterCheckbox').addEventListener('change', (e) => {\n    const checkedState = e.currentTarget.checked;\n    const ulActiveList = $('.is-active-list');\n    const checkedItems = $all('.bulk-actions__checkbox', ulActiveList);\n    checkedItems.forEach((x) => {\n      const todoItem = x.parentNode;\n      x.checked = checkedState;\n      if (x.checked === true) {\n        todoItem.classList.add('is-checked');\n      } else {\n        todoItem.classList.remove('is-checked');\n      }\n    });\n    const bulkActions = $all('.toolbar__btn[data-bulk-action=\"true\"]');\n    if (checkedState === true && checkedItems.length > 0) {\n      // Enable bulk action buttons\n      bulkActions.forEach((btn) => (btn.disabled = false));\n    } else {\n      // Disable bulk action buttons\n      bulkActions.forEach((btn) => (btn.disabled = true));\n    }\n  });\n\n  $('#btnDeleteList').addEventListener('click', (e) => {\n    deleteList(state.activeList);\n  });\n  formEditList.addEventListener('submit', updateList);\n\n  $('#listActionsWrapper').addEventListener('click', (e) => {\n    if (!e.target.classList.contains('more-actions__item')) return;\n\n    const action = e.target.dataset.action;\n\n    switch (action) {\n      case 'editList':\n        prepEditListForm(e);\n        break;\n      case 'initBulkEditing':\n        initBulkEditing(e);\n        break;\n      case 'clearAll':\n        $('#alertWarningClearAll').classList.add('is-active');\n        break;\n      case 'deleteList':\n        $('#alertWarningDeleteList .list-name').textContent =\n          state.activeList.name;\n        $('#alertWarningDeleteList').classList.add('is-active');\n        break;\n    }\n    e.currentTarget.classList.remove('show-actions');\n  });\n\n  $('#helpActionsWrapper').addEventListener('click', (e) => {\n    if (!e.target.classList.contains('more-actions__item')) return;\n    const action = e.target.dataset.action;\n    switch (action) {\n      case 'openTour':\n        $('#siteWrapper').classList.remove('show-nav');\n        $('#onboarding').classList.add('is-active');\n        break;\n    }\n    e.currentTarget.classList.remove('show-actions');\n  });\n\n  $('#clearAllBtn').addEventListener('click', clearAll);\n\n  $all('.more-actions__btn--toggle').forEach((btn) => {\n    btn.addEventListener('click', (e) => {\n      const moreActionsWrapper = e.currentTarget.parentNode;\n      if (btn.classList.contains('list-actions__btn--toggle')) {\n        if (todoAppContainer.classList.contains('show-task-details')) {\n          todoAppContainer.classList.remove('show-task-details');\n        }\n\n        // Disables bulk editing button if toolbar is active\n        if ($('#bulkActionsToolbar').classList.contains('is-active')) {\n          $('#btnInitBulkEditing').disabled = true;\n        } else {\n          $('#btnInitBulkEditing').disabled = false;\n        }\n\n        $all('button[data-required=\"custom-list\"]', moreActionsWrapper).forEach(\n          (item) => {\n            if (\n              state.activeList === null ||\n              state.activeList.name === 'Inbox'\n            ) {\n              item.disabled = true;\n            } else {\n              item.disabled = false;\n            }\n          }\n        );\n      }\n      moreActionsWrapper.classList.toggle('show-actions');\n    });\n  });\n\n  searchBar.addEventListener('click', expandSearchBar);\n\n  $('#btnAddTag').addEventListener('click', addTag);\n\n  document.querySelectorAll('.sidebar__btn--toggle').forEach((btn) => {\n    btn.addEventListener('click', toggleMenu, true);\n  });\n  divViews.addEventListener('click', updateView);\n  formAddTodo.addEventListener('submit', addTodo);\n  $('#todoInput').addEventListener('focus', (e) => {\n    e.currentTarget.parentNode.classList.add('is-focused');\n  });\n  ulSubtasks.addEventListener('click', toggleComplete);\n  ulSubtasks.addEventListener('input', (e) => {\n    if (!e.target.classList.contains('edit-todo-form__textarea--subtask'))\n      return;\n    autoHeightResize(e.target);\n  });\n  formEditTodo.addEventListener('submit', addSubtask);\n  $('#btnAddSubtask').addEventListener('click', addSubtask);\n  colorPicker.addEventListener('click', setTagColor);\n\n  formEditTodo.addEventListener('keyup', (e) => {\n    if (e.keyCode === ENTER_KEY) {\n      if (e.target === $('#newSubtaskInput')) {\n        addSubtask(e);\n      }\n      if (e.target === $('#newTagInput')) {\n        addTag(e);\n      }\n    }\n  });\n\n  $('#todoItemNote').addEventListener('change', addNote);\n  formEditTodo.addEventListener('change', editSubtask);\n\n  // Delete tag on double backspace\n  formEditTodo.addEventListener('keyup', (e) => {\n    const newTagInput = $('#newTagInput');\n    if (e.target !== newTagInput) return;\n    const id = e.currentTarget.dataset.id;\n    const todoIndex = state.activeList.tasks.findIndex(\n      (task) => task.id === id\n    );\n    const currentTask = state.activeList.tasks.find((task) => task.id === id);\n    if (currentTask.tags.length > 0) {\n      const lastIndex = currentTask.tags.length - 1;\n      const lastTag = formEditTodo.querySelectorAll('#tagsContainer .tag')[\n        lastIndex\n      ];\n      const lastTagBtn = lastTag.querySelector('.close-icon');\n      if (e.keyCode === BACKSPACE_KEY && !newTagInput.value) {\n        lastTag.classList.add('is-focused');\n        // Removes tag when backspace key is hit consecutively\n        setTimeout(() => {\n          lastTagBtn.value = 'true';\n        }, 10);\n        if (lastTagBtn.value === 'true') {\n          if (lastTag.contains(colorPicker)) {\n            formEditTodo.appendChild(colorPicker);\n            colorPicker.classList.remove('is-visible');\n          }\n          removeTag(todoIndex, lastIndex);\n          lastTag.classList.remove('is-focused');\n        }\n        lastTagBtn.value = 'false';\n      } else if (e.keyCode !== BACKSPACE_KEY) {\n        lastTag.classList.remove('is-focused');\n        lastTagBtn.value = 'false';\n      }\n    }\n  });\n\n  formSearch.addEventListener('submit', filterTasks);\n\n  inputSearch.addEventListener('click', (e) => e.currentTarget.select());\n\n  document.body.addEventListener(clickTouch(), hideComponents);\n\n  $all(\"[data-action='openListForm']\").forEach((btn) => {\n    btn.addEventListener('click', (e) => {\n      if (document.documentElement.clientWidth < 768) {\n        $('#siteWrapper').classList.remove('show-nav');\n      }\n      if (!formNewList.contains(fieldsetFolders)) {\n        formNewList.insertBefore(fieldsetFolders, $('#addListBtn'));\n      }\n      $('#newListFormContainer').classList.add('is-active');\n      window.setTimeout(() => {\n        $('#newListNameInput').focus();\n      }, 200);\n    });\n  });\n\n  formNewList.addEventListener('submit', addList);\n  inputNewFolder.addEventListener('click', (e) => {\n    const newFolderRadio = $('input[id=\"folderNew\"]');\n    newFolderRadio.checked = true;\n  });\n\n  inputNewFolder.addEventListener('input', (e) => {\n    if (e.currentTarget.value !== '') {\n      $('#formGroupCreateFolder').classList.add('is-active');\n    } else {\n      $('#formGroupCreateFolder').classList.remove('is-active');\n    }\n  });\n\n  // Prevents empty folder names from being created\n  inputNewFolder.addEventListener('blur', (e) => {\n    const noFolderRadio = $('input[id=\"folderNone\"]');\n    if (e.currentTarget.value === '') {\n      noFolderRadio.checked = true;\n    }\n  });\n\n  $all('.modal').forEach((modal) =>\n    modal.addEventListener('click', closeModal)\n  );\n\n  $all('.tooltip').forEach((tooltip) =>\n    tooltip.addEventListener('click', closeTooltip)\n  );\n  $all('.error').forEach((error) => error.addEventListener('click', hideError));\n\n  $all('.dp-calendar__toggle-btn').forEach((btn) => {\n    btn.addEventListener('click', (e) => {\n      e.currentTarget.nextElementSibling.classList.toggle('is-active');\n      e.currentTarget.classList.toggle('is-active');\n    });\n  });\n\n  $all('.dp-calendar__dropdown').forEach((x) => {\n    if (x.dataset.name === 'month') {\n      x.addEventListener('click', selectMonth);\n    } else if (x.dataset.name == 'year') {\n      x.addEventListener('click', selectYear);\n    }\n  });\n\n  function selectPrevNext(e) {\n    const action = e.target.dataset.action;\n    const selectedMonth = $('input[name=\"month\"]:checked').value;\n    const selectedYear = $('input[name=\"year\"]:checked').value;\n    const selectedMonthIndex = monthsArr.findIndex(\n      (x) => x.name === selectedMonth\n    );\n    const prevMonth =\n      selectedMonthIndex !== 0\n        ? monthsArr[selectedMonthIndex - 1].name\n        : 'December';\n    const nextMonth =\n      selectedMonthIndex !== 11\n        ? monthsArr[selectedMonthIndex + 1].name\n        : 'January';\n    const currentDueDate = $('#inputDueDate').value; // mm/dd/yy\n    const dueMonthIndex = +currentDueDate.slice(0, 2) - 1;\n    const dueMonth = monthsArr[dueMonthIndex].name;\n    const dueDay = +currentDueDate.slice(3, 5);\n    const dueYear = `20${currentDueDate.slice(6)}`;\n    console.log({ dueDay });\n\n    if (action === 'selectNextMonth') {\n      if (nextMonth === 'January') {\n        const nextYear = +selectedYear + 1;\n        $(`input[value=\"${nextYear}\"]`).checked = true;\n        $('#btnToggleYearDropdown .btn-text').textContent = nextYear;\n      }\n      $(`input[value=\"${nextMonth}\"]`).checked = true;\n      $('#btnToggleMonthDropdown .btn-text').textContent = nextMonth;\n      populateCalendarDays(nextMonth);\n      if (nextMonth === dueMonth && selectedYear === dueYear) {\n        $(\n          `.dp-calendar__btn--select-day[value=\"${dueDay}\"][data-month=\"${dueMonth}\"]`\n        ).classList.add('is-selected');\n      }\n    }\n\n    if (action === 'selectPrevMonth') {\n      if (prevMonth === 'December') {\n        const prevYear = +selectedYear - 1;\n        $(`input[value=\"${prevYear}\"]`).checked = true;\n        $('#btnToggleYearDropdown .btn-text').textContent = prevYear;\n      }\n      $(`input[value=\"${prevMonth}\"]`).checked = true;\n      $('#btnToggleMonthDropdown .btn-text').textContent = prevMonth;\n      populateCalendarDays(prevMonth);\n      if (prevMonth === dueMonth && selectedYear === dueYear) {\n        console.log({ selectedYear });\n        $(\n          `.dp-calendar__btn--select-day[value=\"${dueDay}\"][data-month=\"${dueMonth}\"]`\n        ).classList.add('is-selected');\n      }\n    }\n  }\n  // Select previous or next month on click\n  $all('.dp-calendar__btn-prevnext').forEach((x) =>\n    x.addEventListener('click', selectPrevNext)\n  );\n\n  $('#dpCalendarDayPicker').addEventListener('click', selectDay);\n  $('#btnSetDueDate').addEventListener('click', setDueDate);\n\n  $('#dueDateWrapper').addEventListener('click', (e) => {\n    initDpCalendar(e);\n    e.currentTarget.parentNode.classList.add('is-focused');\n    e.currentTarget.classList.add('show-input');\n    $('#dpCalendar').classList.add('is-active');\n  });\n\n  $('#inputDueDate').addEventListener('change', (e) => {\n    const dateRegex = /[01][0-9]\\/[0-3][0-9]\\/[12][0-9]/; // mm/dd/yy\n\n    if (!dateRegex.test(e.target.value)) {\n      // Returns value for month as a double digit\n      if (/^[0-9]\\//.test(e.target.value)) {\n        const foo = e.target.value;\n        e.target.value = `0${foo}`;\n      }\n\n      // Returns value for day as a double digit\n      if (/^[01][0-9]\\/[0-9]-/.test(e.target.value)) {\n        const foo = e.target.value;\n        e.target.value = `${foo.slice(0, 3)}0${foo.slice(3)}`;\n      }\n    }\n\n    if (dateRegex.test(e.target.value)) {\n      const dateStr = $('#inputDueDate').value; // mm/dd/yy\n      console.log({ dateStr });\n\n      const selectedDay = $('.dp-calendar__btn--select-day.is-selected');\n      const year = `20${dateStr.slice(6)}`;\n      console.log({ year });\n      const monthNum = +dateStr.slice(0, 2) - 1;\n      const month = monthsArr[monthNum];\n      const monthText = month.name;\n      if (monthText === 'February') {\n        month.daysTotal = isLeapYear(+year) ? 29 : 28;\n      }\n\n      const lastDay = month.daysTotal;\n      const day =\n        +dateStr.slice(3, 5) > lastDay\n          ? (updateDateInput('day', lastDay), lastDay)\n          : +dateStr.slice(3, 5);\n\n      console.log({ day });\n\n      if ($(`input[name=\"year\"]:checked`).value !== year) {\n        $(`input[value=\"${year}\"]`).checked = true;\n        $('#btnToggleYearDropdown .btn-text').textContent = year;\n        populateCalendarDays(monthText);\n        $(\n          `.dp-calendar__btn--select-day[value=\"${day}\"][data-month=\"${monthText}\"]`\n        ).classList.add('is-selected');\n      }\n\n      if ($(`input[name=\"month\"]:checked`).value !== monthText) {\n        $(`input[value=\"${monthText}\"]`).checked = true;\n        $('#btnToggleMonthDropdown .btn-text').textContent = monthText;\n        populateCalendarDays(monthText);\n      }\n\n      if (selectedDay && selectedDay.value !== day) {\n        $all('.dp-calendar__btn--select-day').forEach((x) => {\n          if (\n            x.value == day &&\n            !x.classList.contains('dp-calendar__btn--prev-month') &&\n            !x.classList.contains('dp-calendar__btn--next-month')\n          ) {\n            x.classList.add('is-selected');\n          } else {\n            x.classList.remove('is-selected');\n          }\n        });\n      }\n    }\n  });\n\n  $('#todayNavLink').addEventListener('click', (e) => {\n    displayTaskSchedule('today', $('#today'));\n  });\n\n  $('#upcomingNavLink').addEventListener('click', (e) => {\n    displayTaskSchedule('upcoming', $('#upcoming'));\n  });\n\n  $('#btnClearDueDate').addEventListener('click', (e) => {\n    const id = hiddenTaskId.value;\n    const currentTask = state.activeList.getTask(id);\n    const todoItem = $(`#${id}`);\n    currentTask.dueDate = null;\n    saveToStorage();\n    const dueDateWrapper = $('#dueDateWrapper');\n    dueDateWrapper.classList.remove('has-due-date');\n    $('.due-date-text', dueDateWrapper).textContent = 'Set due date';\n    dueDateWrapper.classList.remove('show-input');\n    dueDateWrapper.parentNode.classList.remove('is-focused');\n    $('#dpCalendar').classList.remove('is-active');\n    $('.badge--due-date', todoItem).remove();\n  });\n\n  $('#btnResetDueDate').addEventListener('click', (e) => {\n    $('#dueDateWrapper').classList.remove('show-input');\n    $('#dueDateWrapper').parentNode.classList.remove('is-focused');\n    $('#dpCalendar').classList.remove('is-active');\n  });\n\n  $all('.edit-todo-form__control').forEach((x) => {\n    x.addEventListener('focus', (e) => {\n      const parent = e.currentTarget.parentNode;\n      const grandparent = parent.parentNode;\n      if (grandparent.classList.contains('edit-todo-form__form-group')) {\n        grandparent.classList.add('is-focused');\n      } else {\n        parent.classList.add('is-focused');\n      }\n    });\n    x.addEventListener('focusout', (e) => {\n      const parent = e.currentTarget.parentNode;\n      const grandparent = parent.parentNode;\n      if (grandparent.classList.contains('edit-todo-form__form-group')) {\n        grandparent.classList.remove('is-focused');\n      } else {\n        parent.classList.remove('is-focused');\n      }\n    });\n  });\n\n  $('#btnTriggerWarningDeleteTask').addEventListener('click', (e) => {\n    const taskId = hiddenTaskId.value;\n    const currentTask = state.activeList.getTask(taskId);\n    $('#alertWarningDeleteTask .task-text').textContent = currentTask.text;\n    $('#alertWarningDeleteTask').classList.add('is-active');\n  });\n\n  $('#btnDeleteTask').addEventListener('click', (e) => {\n    const taskId = hiddenTaskId.value;\n    deleteTask(state.activeList, taskId);\n  });\n})();\n"]}